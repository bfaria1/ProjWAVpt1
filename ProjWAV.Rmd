---
title: "ProjWAV"
author: "Beatriz de Faria"
date: "09/12/2020"
output:
  word_document: default
  html_document: default
---

```{r}
library("openxlsx") 
library(ggplot2)
library(RColorBrewer)
library(dplyr)
library(ggpubr)
library(tidyr)
library(hrbrthemes)
library(sf)
library(geobr)
library(factoextra)
library(ade4)
library(vegan)
library(gclus)
library(cluster)
library(FD)
library(ggcorrplot)
```

# Seção 1

```{r}
WS <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/WAVxSPL.xlsx") 
WAV <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/WAV.xlsx") 
SPL <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/SPL.xlsx")
ESP <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/Espécies.xlsx")
dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S1/dados.xlsx")
```

## Representação 1

```{r}
A1 <- hist(WAV$WAVR, 
           plot = FALSE, 
           breaks = c(0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.8,2.0,2.2,2.4,2.6,2.8,3.0,3.2,3.4,3.6,3.8,4.0,4.2,4.4,4.6,4.8,5.0))
A1$density = A1$counts/sum(A1$counts)*100

B1 <- hist(SPL$SPLR, 
           plot = FALSE, 
           breaks = c(0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.8,2.0,2.2,2.4,2.6,2.8,3.0,3.2,3.4,3.6,3.8,4.0,4.2,4.4,4.6,4.8,5.0))
B1$density = B1$counts/sum(B1$counts)*100

C1 <- hist (WS$WAV2R, 
            plot = FALSE, 
            breaks = c(0,0.2,0.4,0.6,0.8,1.0,1.2,1.4,1.6,1.8,2.0,2.2,2.4,2.6,2.8,3.0,3.2,3.4,3.6,3.8,4.0,4.2,4.4,4.6,4.8,5.0))
C1$density = C1$counts/sum(C1$counts)*100

A2 <- hist(WAV$WAVE, 
           plot = FALSE, 
           breaks = c(0,0.12,0.24,0.36,0.48,0.60,0.72,0.84,0.96,1.08,1.20,1.32,1.44,1.56,1.68,1.80,1.92,2.04,2.16,2.28,2.40,2.52,2.64,2.76,2.88,3.00)) 
A2$density = A2$counts/sum(A2$counts)*100

B2 <- hist(SPL$SPLE, 
           plot = FALSE, 
           breaks = c(0,0.12,0.24,0.36,0.48,0.60,0.72,0.84,0.96,1.08,1.20,1.32,1.44,1.56,1.68,1.80,1.92,2.04,2.16,2.28,2.40,2.52,2.64,2.76,2.88,3.00))
B2$density = B2$counts/sum(B2$counts)*100

C2 <- hist(WS$WAV2E, 
           plot = FALSE,
           breaks = c(0,0.12,0.24,0.36,0.48,0.60,0.72,0.84,0.96,1.08,1.20,1.32,1.44,1.56,1.68,1.80,1.92,2.04,2.16,2.28,2.40,2.52,2.64,2.76,2.88,3.00)) 
C2$density = C2$counts/sum(C2$counts)*100

A3 <- hist(ESP$WAV, 
           plot = FALSE, 
           breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
A3$density = A3$counts/sum(A3$counts)*100

B3 <- hist(ESP$SPL, 
           plot = FALSE, 
           breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
B3$density = B3$counts/sum(B3$counts)*100

C3 <- hist(ESP$WAV2, 
           plot = FALSE,
           breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
C3$density = C3$counts/sum(C3$counts)*100
```

```{r}
plot(A1, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Número de Registros (Log10)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(0,5))
plot(B1, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
plot(C1, col=rgb(0,1,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink","Wikiaves 2"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ,rgb(0,1,0,1/2) ), lwd=5, box.col = "white")
```

```{r}
plot(A2, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Número de Espécies (Log10)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,25),
     xlim=c(0,3))
plot(B2, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
plot(C2, col=rgb(0,1,0,1/2), freq = FALSE, add=T)
legend("top", c("Wikiaves", "SpeciesLink","Wikiaves 2"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ,rgb(0,1,0,1/2) ), lwd=5, box.col = "white")
```

```{r}
plot(A3, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Número de Registros por Espécie (Log10)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(0,4))
plot(B3, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
plot(C3, col=rgb(0,1,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink","Wikiaves 2"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ,rgb(0,1,0,1/2) ), lwd=5, box.col = "white")
```

## Representação 2

```{r}
dados$L <- factor(dados$L, levels = c("WAV", "SPL", "WAV 2"), labels = c("WAV (N = 631)", "SLI (N = 174)", "WAV 2 (N = 173)"))

ggplot(dados, aes(x = R, fill = L, colour = L))+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_fill_manual(values = c("blue", "red", "green")) +
  geom_density(alpha = 0.2)+
  labs(x = "Quantidade de Registros (Log10)",
       y = "Densidade",
       colour  = "",
       fill = "")+
  theme_classic()
```

```{r}
ggplot(dados, aes(x = E, fill = L, colour = L))+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_fill_manual(values = c("blue", "red", "green")) +
  geom_density(alpha = 0.2)+
  labs(x = "Quantidade de Espécies (Log10)",
       y = "Densidade",
       colour  = "",
       fill = "")+
  theme_classic()
```

```{r}
dados$L2 <- factor(dados$L2, levels = c("WAV", "SPL", "WAV 2"), labels = c("WAV (S = 790)", "SLI (S = 661)", "WAV 2 (S = 779)"))

ggplot(dados, aes(x = RE, fill = L2, colour = L2))+
  scale_colour_manual(values = c("red", "blue", "green")) +
  scale_fill_manual(values = c("red", "blue", "green")) +
  geom_density(alpha = 0.2)+
  labs(x = "Quantidade de Registros (Log10)",
       y = "Densidade",
       colour  = "",
       fill = "")+
  theme_classic()
```

## Representação 3

```{r}
y1 <- A1$density
x1 <- c()
x1[1] <- 0.1
for (i in 1:24){
  x1[i+1] = x1[i]+0.2
}


y2 <- B1$density
x2 <- c()
x2[1] <- 0.1
for (i in 1:24){
  x2[i+1] = x2[i]+0.2
}


y3 <- C1$density
x3 <- c()
x3[1] <- 0.1
for (i in 1:24){
  x3[i+1] = x3[i]+0.2
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SLI (N = 174)"
}
for (i in 51:75){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}
for(i  in 51:75){
  B[i] = x3[i-50]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}
for(i  in 51:75){
  C[i] = y3[i-50]
}

dados <- data.frame(L = A, x = B, y = C)
dados$L <- factor(dados$L, levels = c("WAV (N = 631)", "SLI (N = 174)", "WAV 2 (N = 173)"))

ggplot(dados, aes(x = x, y = C, group = L, colour = L))+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Número de Registros (Log10)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```


```{r}
y1 <- A2$density
x1 <- c()
x1[1] <- 0.1
for (i in 1:24){
  x1[i+1] = x1[i]+0.12
}

y2 <- B2$density
x2 <- c()
x2[1] <- 0.1
for (i in 1:24){
  x2[i+1] = x2[i]+0.12
}

y3 <- C2$density
x3 <- c()
x3[1] <- 0.1
for (i in 1:24){
  x3[i+1] = x3[i]+0.12
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SLI (N = 174)"
}
for (i in 51:75){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}
for(i  in 51:75){
  B[i] = x3[i-50]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}
for(i  in 51:75){
  C[i] = y3[i-50]
}

dados <- data.frame(L = A, x = B, y = C)
dados$L <- factor(dados$L, levels = c("WAV (N = 631)", "SLI (N = 174)", "WAV 2 (N = 173)"))

ggplot(dados, aes(x = x, y = C, group = L, colour = L))+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Número de Espécies (Log10)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

```{r}
y1 <- A3$density
x1 <- c()
x1[1] <- 0.1
for (i in 1:24){
  x1[i+1] = x1[i]+0.16
}

y2 <- B3$density
x2 <- c()
x2[1] <- 0.1
for (i in 1:24){
  x2[i+1] = x2[i]+0.16
}

y3 <- C3$density
x3 <- c()
x3[1] <- 0.1
for (i in 1:24){
  x3[i+1] = x3[i]+0.16
}


A <- c()

for (i in 1:25){
  A[i] = "WAV (S = 790)"
}
for (i in 26:50){
  A[i] = "SLI (S = 661)"
}
for (i in 51:75){
  A[i] = "WAV 2 (S = 779)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}
for(i  in 51:75){
  B[i] = x3[i-50]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}
for(i  in 51:75){
  C[i] = y3[i-50]
}

dados <- data.frame(L = A, x = B, y = C)
dados$L <- factor(dados$L, levels = c("WAV (S = 790)", "SLI (S = 661)", "WAV 2 (S = 779)"))

ggplot(dados, aes(x = x, y = C, group = L, colour = L))+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Número de Registros por Espécie (Log10)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

```{r}
rm(list=ls())
```

# Seção 2

```{r}
FE <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S2/FE.xlsx")
dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S2/Dados.xlsx")
```

## Representação 1

```{r}
WAL <- hist(FE$WAVAL, 
            plot = FALSE, 
            breaks = c(0,72,144,216,288,360,432,504,576,648,720,792,864,936,1008,1080,1152,1224,1296,1368,1440,1512,1584,1656,1782,1800))
WAL$density = WAL$counts/sum(WAL$counts)*100

SAL <- hist(FE$SPLAL, 
            plot = FALSE, 
            breaks = c(0,72,144,216,288,360,432,504,576,648,720,792,864,936,1008,1080,1152,1224,1296,1368,1440,1512,1584,1656,1782,1800))
SAL$density = SAL$counts/sum(SAL$counts)*100

WAR <- hist(FE$WAVAR, 
            plot = FALSE, 
            breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
WAR$density = WAR$counts/sum(WAR$counts)*100

SAR <- hist(FE$SPLAR, 
            plot = FALSE, 
            breaks = c(0,0.16,0.32,0.48,0.64,0.8,0.96,1.12,1.28,1.44,1.60,1.76,1.92,2.08,2.24,2.40,2.56,2.72,2.88,3.04,3.20,3.36,3.52,3.68,3.84,4.00))
SAR$density = SAR$counts/sum(SAR$counts)*100

WPOP <- hist(FE$WAVPOP, 
             plot = FALSE, 
             breaks = c(2,2.22,2.44,2.66,2.88,3.1,3.32,3.54,3.76,3.98,4.2,4.42,4.64,4.86,5.08,5.3,5.52,5.74,5.96,6.18,6.4,6.62,6.84,7.06,7.28,7.5))
WPOP$density = WPOP$counts/sum(WPOP$counts)*100

SPOP <- hist(FE$SPLPOP, 
             plot = FALSE, 
             breaks = c(2,2.22,2.44,2.66,2.88,3.1,3.32,3.54,3.76,3.98,4.2,4.42,4.64,4.86,5.08,5.3,5.52,5.74,5.96,6.18,6.4,6.62,6.84,7.06,7.28,7.5))
SPOP$density = SPOP$counts/sum(SPOP$counts)*100

WLA <- hist(FE$WAVLA, 
            plot = FALSE, 
            breaks = c(-25.5,-25.26,-25.02,-24.78,-24.54,-24.3,-24.06,-23.82,-23.58,-23.34,-23.1,-22.86,-22.62,-22.38,-22.14,-21.9,-21.66,-21.42,-21.18,-20.94,-20.7,-20.46,-20.22,-19.98,-19.74,-19,5))
WLA$density = WLA$counts/sum(WLA$counts)*100

SLA <- hist(FE$SPLLA, 
            plot = FALSE, 
            breaks = c(-25.5,-25.26,-25.02,-24.78,-24.54,-24.3,-24.06,-23.82,-23.58,-23.34,-23.1,-22.86,-22.62,-22.38,-22.14,-21.9,-21.66,-21.42,-21.18,-20.94,-20.7,-20.46,-20.22,-19.98,-19.74,-19,5))
SLA$density = SLA$counts/sum(SLA$counts)*100

WLO <- hist(FE$WAVLO, 
            plot = FALSE, 
            breaks = c(-55,-54.48,-53.96,-53.44,-52.92,-52.4,-51.88,-51.36,-50.84,-50.32,-49.8,-49.28,-48.76,-48.24,-47.72,-47.2,-46.68,-46.16,-45.64,-45.12,-44.6,-44.08,-43.56,-43.04,-42.52,-42))
WLO$density = WLO$counts/sum(WLO$counts)*100

SLO <- hist(FE$SPLLO, 
            plot = FALSE, 
            breaks = c(-55,-54.48,-53.96,-53.44,-52.92,-52.4,-51.88,-51.36,-50.84,-50.32,-49.8,-49.28,-48.76,-48.24,-47.72,-47.2,-46.68,-46.16,-45.64,-45.12,-44.6,-44.08,-43.56,-43.04,-42.52,-42))
SLO$density = SLO$counts/sum(SLO$counts)*100
```

### Altitude

```{r}
plot(WAL, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Altitude (m)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     #ylim = c(0,1),
     xlim=c(0,1800))
plot(SAL, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

### Área

```{r}
plot(WAR, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Área (Log10(Km^2))",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(0,4))
plot(SAR, col=rgb(1,0,0,1/2), freq = FALSE, add=T) 
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

### População

```{r}
plot(WPOP, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "População (Log10)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(2,7.5))
plot(SPOP, col=rgb(1,0,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

### Latitude

```{r}
plot(WLA, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Latitude (°)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,15),
     xlim=c(-25.5,-19.5))
plot(SLA, col=rgb(1,0,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

### Longitude

```{r}
plot(WLO, col=rgb(0,0,1,1/2),
     main = " ",
     xlab = "Longitude (°)",
     ylab = "Frequência Relativa (%)",
     freq = FALSE,
     ylim = c(0,20),
     xlim=c(-55,-42))
plot(SLO, col=rgb(1,0,0,1/2), freq = FALSE, add=T)
legend("topright", c("Wikiaves", "SpeciesLink"), col=c(rgb(0,0,1,1/2),col=rgb(1,0,0,1/2) ), lwd=5, box.col = "white")
```

## Representação 2

### Altitude

```{r}
dados$L <- factor(dados$L, levels = c("WAV", "SPL"), labels = c("WAV (N = 631)", "SLI (N = 174)"))

ggplot(dados, aes(x = Altitude, fill = L, colour = L))+
        scale_colour_manual(values = c("blue", "red")) +
        scale_fill_manual(values = c("blue", "red")) +
        geom_density(alpha = 0.2)+
        labs(x = "Altitude (m)",
             y = "Densidade",
       colour  = "",
       fill = "")+
        theme_classic()
```

### Área

```{r}
ggplot(dados, aes(x = Área, fill = L, colour = L))+
        scale_colour_manual(values = c("blue", "red")) +
        scale_fill_manual(values = c("blue", "red")) +
        geom_density(alpha = 0.2)+
        labs(x = "Área (Log10(km^2))",
             y = "Densidade",
       colour  = "",
       fill = "")+
        theme_classic()
```

### População

```{r}
ggplot(dados, aes(x = População, fill = L, colour = L))+
        scale_colour_manual(values = c("blue", "red")) +
        scale_fill_manual(values = c("blue", "red")) +
        geom_density(alpha = 0.2)+
        labs(x = "População (log10)",
             y = "Densidade",
       colour  = "",
       fill = "")+
        theme_classic()
```

### Latitude

```{r}
ggplot(dados, aes(x = Latitude, fill = L, colour = L))+
        scale_colour_manual(values = c("blue", "red")) +
        scale_fill_manual(values = c("blue", "red")) +
        geom_density(alpha = 0.2)+
        labs(x = "Latitude (º)",
             y = "Densidade",
       colour  = "",
       fill = "")+
        theme_classic()
```

### Longitude

```{r}
ggplot(dados, aes(x = Longitude, fill = L, colour = L))+
        scale_colour_manual(values = c("blue", "red")) +
        scale_fill_manual(values = c("blue", "red")) +
        geom_density(alpha = 0.2)+
        labs(x = "Longitude (º)",
             y = "Densidade",
       colour  = "",
       fill = "")+
        theme_classic()

```

## Representação 3

### Altitude

```{r}
y1 <- WAL$density
x1 <- c()
x1[1] <- 36
for (i in 1:24){
  x1[i+1] = x1[i]+72
}

y2 <- SAL$density
x2 <- c()
x2[1] <- 36
for (i in 1:24){
  x2[i+1] = x2[i]+72
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)
dados$Legenda <- factor(dados$Legenda, levels = c("WAV (N = 631)", "SPL (N = 174)"))

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("blue", "red")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Altitude (m)",
       y = "Frequência Relativa %",
       colour = " ")+
  theme_classic()
```

### Área

```{r}
y1 <- WAR$density
x1 <- c()
x1[1] <- 0.08
for (i in 1:24){
  x1[i+1] = x1[i]+0.16
}

y2 <- SAR$density
x2 <- c()
x2[1] <- 0.08
for (i in 1:24){
  x2[i+1] = x2[i]+0.16
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)
dados$Legenda <- factor(dados$Legenda, levels = c("WAV (N = 631)", "SPL (N = 174)"))

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("blue", "red")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Área (Log10(km^2))",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

### População

```{r}
y1 <- WPOP$density
x1 <- c()
x1[1] <- 2.11
for (i in 1:24){
  x1[i+1] = x1[i]+0.22
}

y2 <- SPOP$density
x2 <- c()
x2[1] <- 2.11
for (i in 1:24){
  x2[i+1] = x2[i]+0.22
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)
dados$Legenda <- factor(dados$Legenda, levels = c("WAV (N = 631)", "SPL (N = 174)"))

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("blue", "red")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Número de habitantes (Log10)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

### Latitude

```{r}
y1 <- WLA$density
x1 <- c()
x1[1] <- -25.38
for (i in 1:24){
  x1[i+1] = x1[i]+0.24
}

y2 <- SLA$density
x2 <- c()
x2[1] <- -25.38
for (i in 1:24){
  x2[i+1] = x2[i]+0.24
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)
dados$Legenda <- factor(dados$Legenda, levels = c("WAV (N = 631)", "SPL (N = 174)"))

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("blue", "red")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE, fullrange = TRUE)+
  labs(x = "Latitude (º)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```

### Longitude

```{r}
y1 <- WLO$density
x1 <- c()
x1[1] <- -54.64
for (i in 1:24){
  x1[i+1] = x1[i]+0.72
}

y2 <- SLO$density
x2 <- c()
x2[1] <- -54.64
for (i in 1:24){
  x2[i+1] = x2[i]+0.72
}

A <- c()

for (i in 1:25){
  A[i] = "WAV (N = 631)"
}
for (i in 26:50){
  A[i] = "SPL (N = 174)"
}

B <- c()

for (i in 1:25){
  B[i] = x1[i]
}

for(i in 26:50){
  B[i] = x2[i-25]
}

C<- c()

for (i in 1:25){
  C[i] = y1[i]
}

for(i in 26:50){
  C[i] = y2[i-25]
}

dados <- data.frame(Legenda = A, x = B, y = C)
dados$Legenda <- factor(dados$Legenda, levels = c("WAV (N = 631)", "SPL (N = 174)"))

ggplot(dados, aes(x = x, y = C, group = Legenda, colour = Legenda))+
  scale_colour_manual(values = c("blue", "red")) +
  stat_smooth(method = lm, formula = y ~ poly(x, 15),se = FALSE)+
  labs(x = "Longitude (º)",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()
```


## Representação 3

```{r}
rm(list=ls())
```
# Seção 3

```{r}
AL <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Altitude.xlsx")
AR <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Area.xlsx")
POP <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Populacao.xlsx")
LA <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Latitude.xlsx")
LO <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Longitude.xlsx")
dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S3/Auxiliar.xlsx")
```

## Estatísticas 

### Altitude

```{r}
REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)
```

#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```

### Área

```{r}
REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)
```

#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```


### População

```{r}
REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)
```

#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```


### Latitude

```{r}
REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)
```


#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```

### Longitude

```{r}
REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)
```

#### Registros Wikiaves

```{r}
summary(REW)
```

#### Registros SpeciesLink

```{r}
summary(RES) 
```

#### Registros Wikiaves 2

```{r}
summary(RE)
```

```{r}
REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)
```

#### Espécies Wikiaves

```{r}
summary(REW)
```

#### Espécies SpeciesLink

```{r}
summary(RES) 
```

#### Espécies Wikiaves 2

```{r}
summary(RE)
```

## Representação 1.1.

### Altitude

#### Registros

```{r}
AL$L1 <- factor(AL$L1, levels=c("WAV (N = 598)", "SLI (N = 145)", "WAV 2 (N = 141)"))

gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  #guides(colour=FALSE)+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)


resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
AL$L2 <- factor(AL$L2, levels=c("WAV (N = 557)", "SLI (N = 147)", "WAV 2 (N = 136)"))

gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}
AR$L1 <- factor(AR$L1, levels=c("WAV (N = 624)", "SLI (N = 171)", "WAV 2 (N = 168)"))

gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
AR$L2 <- factor(AR$L2, levels=c("WAV (N = 605)", "SLI (N = 171)", "WAV 2 (N = 161)"))

gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}

POP$L1 <- factor(POP$L1, levels=c("WAV (N = 619)", "SpeciesLink", "WAV 2 (N = 167)") ,labels = c("WAV (N = 619)", "SLI (N = 173)", "WAV 2 (N = 167)"))

gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos",
       colour = " ") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
POP$L2 <- factor(POP$L2, levels=c("WAV (N = 611)", "SLI (N = 173)", "WAV 2 (N = 158)"))

gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)",
        color = " ")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}

LA$L1 <- factor(LA$L1, levels=c("WAV (N = 629)", "SLI (N = 174)", "WAV 2 (N = 170)"))

gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
LA$L2 <- factor(LA$L2, levels=c("WAV (N = 605)", "SLI (N = 174)", "WAV 2 (N = 164)"))

gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
LO$L1 <- factor(LO$L1, levels=c("WAV (N = 627)", "SLI (N = 174)", "WAV 2 (N = 170)"))

gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
LO$L2 <- factor(LO$L2, levels=c("WAV (N = 602)", "SLI (N = 174)", "WAV 2 (N = 167)"))

gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)


R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 1.2.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  #guides(colour=FALSE)+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


  
ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)


a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}

gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 1.3.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  #guides(colour=FALSE)+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-2.1,-1.875,-1.65,-1.425,-1.2,-0.925,-0.75,-0.525,-0.3,-0.075,0.15,0.375,0.6,0.825,1.05,1.275,1.5,1.725,1.95,2.175,2.4))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-2.1,-1.875,-1.65,-1.425,-1.2,-0.925,-0.75,-0.525,-0.3,-0.075,0.15,0.375,0.6,0.825,1.05,1.275,1.5,1.725,1.95,2.175,2.4))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
           breaks = c(-2.1,-1.875,-1.65,-1.425,-1.2,-0.925,-0.75,-0.525,-0.3,-0.075,0.15,0.375,0.6,0.825,1.05,1.275,1.5,1.725,1.95,2.175,2.4))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -2.1
for (i in 1:19){
  x1[i+1] = x1[i]+0.225
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.3,-1.1,-0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.1,1.3,1.5,1.7,1.9,2.1,2.3,2.5,2.7))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.3,-1.1,-0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.1,1.3,1.5,1.7,1.9,2.1,2.3,2.5,2.7))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.3,-1.1,-0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.1,1.3,1.5,1.7,1.9,2.1,2.3,2.5,2.7))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.3
  for (i in 1:19){
    x1[i+1] = x1[i]+0.2
  }

A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}

gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-2.4,-2.165,-1.93,-1.695,-1.46,-1.225,-0.99,-0.755,-0.52,-0.285,-0.05,0.185,0.42,0.655,0.89,1.125,1.36,1.595,1.83,2.065,2.3))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-2.4,-2.165,-1.93,-1.695,-1.46,-1.225,-0.99,-0.755,-0.52,-0.285,-0.05,0.185,0.42,0.655,0.89,1.125,1.36,1.595,1.83,2.065,2.3))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-2.4,-2.165,-1.93,-1.695,-1.46,-1.225,-0.99,-0.755,-0.52,-0.285,-0.05,0.185,0.42,0.655,0.89,1.125,1.36,1.595,1.83,2.065,2.3))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -2.4
  for (i in 1:19){
    x1[i+1] = x1[i]+0.235
  }

A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.4,-1.26,-1.12,-0.98,-0.84,-0.7,-0.56,-0.42,-0.28,-0.14,0,0.14,0.28,0.42,0.56,0.7,0.84,0.98,1.12,1.26,1.4))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.4,-1.26,-1.12,-0.98,-0.84,-0.7,-0.56,-0.42,-0.28,-0.14,0,0.14,0.28,0.42,0.56,0.7,0.84,0.98,1.12,1.26,1.4))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.4,-1.26,-1.12,-0.98,-0.84,-0.7,-0.56,-0.42,-0.28,-0.14,0,0.14,0.28,0.42,0.56,0.7,0.84,0.98,1.12,1.26,1.4))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.4
  for (i in 1:19){
    x1[i+1] = x1[i]+0.14
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.7,-1.495,-1.29,-1.085,-0.88,-0.675,-0.47,-0.265,-0.06,0.145,0.35,0.555,0.76,0.965,1.17,1.375,1.58,1.785,1.99,2.195,2.4))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.7,-1.495,-1.29,-1.085,-0.88,-0.675,-0.47,-0.265,-0.06,0.145,0.35,0.555,0.76,0.965,1.17,1.375,1.58,1.785,1.99,2.195,2.4))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.7,-1.495,-1.29,-1.085,-0.88,-0.675,-0.47,-0.265,-0.06,0.145,0.35,0.555,0.76,0.965,1.17,1.375,1.58,1.785,1.99,2.195,2.4))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.7
  for (i in 1:19){
    x1[i+1] = x1[i]+0.205
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.2,-1.06,-0.92,-0.78,-0.74,-0.5,-0.36,-0.22,-0.08,0.06,0.2,0.34,0.48,0.62,0.76,0.9,1.04,1.18,1.32,1.46,1.6))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.2,-1.06,-0.92,-0.78,-0.74,-0.5,-0.36,-0.22,-0.08,0.06,0.2,0.34,0.48,0.62,0.76,0.9,1.04,1.18,1.32,1.46,1.6))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.2,-1.06,-0.92,-0.78,-0.74,-0.5,-0.36,-0.22,-0.08,0.06,0.2,0.34,0.48,0.62,0.76,0.9,1.04,1.18,1.32,1.46,1.6))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.2
  for (i in 1:19){
    x1[i+1] = x1[i]+0.14
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-2.2,-1.965,-1.73,-1.495,-1.26,-1.025,-0.79,-0.555,-0.32,-0.085,0.15,0.385,0.62,0.855,1.09,1.325,1.56,1.795,2.03,2.265,2.5))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-2.2,-1.965,-1.73,-1.495,-1.26,-1.025,-0.79,-0.555,-0.32,-0.085,0.15,0.385,0.62,0.855,1.09,1.325,1.56,1.795,2.03,2.265,2.5))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-2.2,-1.965,-1.73,-1.495,-1.26,-1.025,-0.79,-0.555,-0.32,-0.085,0.15,0.385,0.62,0.855,1.09,1.325,1.56,1.795,2.03,2.265,2.5))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -2.2
  for (i in 1:19){
    x1[i+1] = x1[i]+0.235
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.4,-1.245,-1.09,-0.935,-0.78,-0.625,-0.47,-0.315,-0.16,-0.005,0.15,0.305,0.46,0.615,0.77,0.925,1.08,1.235,1.39,1.545,1.7))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.4,-1.245,-1.09,-0.935,-0.78,-0.625,-0.47,-0.315,-0.16,-0.005,0.15,0.305,0.46,0.615,0.77,0.925,1.08,1.235,1.39,1.545,1.7))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.4,-1.245,-1.09,-0.935,-0.78,-0.625,-0.47,-0.315,-0.16,-0.005,0.15,0.305,0.46,0.615,0.77,0.925,1.08,1.235,1.39,1.545,1.7))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.4
  for (i in 1:19){
    x1[i+1] = x1[i]+0.155
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.8,-1.59,-1.38,-1.17,-0.96,-0.75,-0.54,-0.33,-0.12,0.09,0.3,0.51,0.72,0.93,1.14,1.35,1.56,1.77,1.98,2.19,2.4))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.8,-1.59,-1.38,-1.17,-0.96,-0.75,-0.54,-0.33,-0.12,0.09,0.3,0.51,0.72,0.93,1.14,1.35,1.56,1.77,1.98,2.19,2.4))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.8,-1.59,-1.38,-1.17,-0.96,-0.75,-0.54,-0.33,-0.12,0.09,0.3,0.51,0.72,0.93,1.14,1.35,1.56,1.77,1.98,2.19,2.4))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.8
  for (i in 1:19){
    x1[i+1] = x1[i]+0.21
  }

A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.2,-1.065,-0.93,-0.795,-0.66,-0.525,-0.39,-0.255,-0.12,0.015,0.15,0.285,0.42,0.555,0.69,0.825,0.96,1.095,1.23,1.365,1.5))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.2,-1.065,-0.93,-0.795,-0.66,-0.525,-0.39,-0.255,-0.12,0.015,0.15,0.285,0.42,0.555,0.69,0.825,0.96,1.095,1.23,1.365,1.5))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.2,-1.065,-0.93,-0.795,-0.66,-0.525,-0.39,-0.255,-0.12,0.015,0.15,0.285,0.42,0.555,0.69,0.825,0.96,1.095,1.23,1.365,1.5))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.2
  for (i in 1:19){
    x1[i+1] = x1[i]+0.135
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 2.1.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  #guides(colour=FALSE)+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}
gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos",
       colour = " ") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 2.2.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


  
ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)


a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}

gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 2.3.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)


R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-2.1,-1.875,-1.65,-1.425,-1.2,-0.925,-0.75,-0.525,-0.3,-0.075,0.15,0.375,0.6,0.825,1.05,1.275,1.5,1.725,1.95,2.175,2.4))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-2.1,-1.875,-1.65,-1.425,-1.2,-0.925,-0.75,-0.525,-0.3,-0.075,0.15,0.375,0.6,0.825,1.05,1.275,1.5,1.725,1.95,2.175,2.4))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-2.1,-1.875,-1.65,-1.425,-1.2,-0.925,-0.75,-0.525,-0.3,-0.075,0.15,0.375,0.6,0.825,1.05,1.275,1.5,1.725,1.95,2.175,2.4))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -2.1
for (i in 1:19){
  x1[i+1] = x1[i]+0.225
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}

gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()



REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)


R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-1.3,-1.1,-0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.1,1.3,1.5,1.7,1.9,2.1,2.3,2.5,2.7))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-1.3,-1.1,-0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.1,1.3,1.5,1.7,1.9,2.1,2.3,2.5,2.7))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-1.3,-1.1,-0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.1,1.3,1.5,1.7,1.9,2.1,2.3,2.5,2.7))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -1.3
for (i in 1:19){
  x1[i+1] = x1[i]+0.2
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}

gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-2.4,-2.165,-1.93,-1.695,-1.46,-1.225,-0.99,-0.755,-0.52,-0.285,-0.05,0.185,0.42,0.655,0.89,1.125,1.36,1.595,1.83,2.065,2.3))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-2.4,-2.165,-1.93,-1.695,-1.46,-1.225,-0.99,-0.755,-0.52,-0.285,-0.05,0.185,0.42,0.655,0.89,1.125,1.36,1.595,1.83,2.065,2.3))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-2.4,-2.165,-1.93,-1.695,-1.46,-1.225,-0.99,-0.755,-0.52,-0.285,-0.05,0.185,0.42,0.655,0.89,1.125,1.36,1.595,1.83,2.065,2.3))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -2.4
for (i in 1:19){
  x1[i+1] = x1[i]+0.235
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```


#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-1.4,-1.26,-1.12,-0.98,-0.84,-0.7,-0.56,-0.42,-0.28,-0.14,0,0.14,0.28,0.42,0.56,0.7,0.84,0.98,1.12,1.26,1.4))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-1.4,-1.26,-1.12,-0.98,-0.84,-0.7,-0.56,-0.42,-0.28,-0.14,0,0.14,0.28,0.42,0.56,0.7,0.84,0.98,1.12,1.26,1.4))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-1.4,-1.26,-1.12,-0.98,-0.84,-0.7,-0.56,-0.42,-0.28,-0.14,0,0.14,0.28,0.42,0.56,0.7,0.84,0.98,1.12,1.26,1.4))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -1.4
for (i in 1:19){
  x1[i+1] = x1[i]+0.14
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-1.7,-1.495,-1.29,-1.085,-0.88,-0.675,-0.47,-0.265,-0.06,0.145,0.35,0.555,0.76,0.965,1.17,1.375,1.58,1.785,1.99,2.195,2.4))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-1.7,-1.495,-1.29,-1.085,-0.88,-0.675,-0.47,-0.265,-0.06,0.145,0.35,0.555,0.76,0.965,1.17,1.375,1.58,1.785,1.99,2.195,2.4))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-1.7,-1.495,-1.29,-1.085,-0.88,-0.675,-0.47,-0.265,-0.06,0.145,0.35,0.555,0.76,0.965,1.17,1.375,1.58,1.785,1.99,2.195,2.4))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -1.7
for (i in 1:19){
  x1[i+1] = x1[i]+0.205
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-1.2,-1.06,-0.92,-0.78,-0.74,-0.5,-0.36,-0.22,-0.08,0.06,0.2,0.34,0.48,0.62,0.76,0.9,1.04,1.18,1.32,1.46,1.6))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-1.2,-1.06,-0.92,-0.78,-0.74,-0.5,-0.36,-0.22,-0.08,0.06,0.2,0.34,0.48,0.62,0.76,0.9,1.04,1.18,1.32,1.46,1.6))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-1.2,-1.06,-0.92,-0.78,-0.74,-0.5,-0.36,-0.22,-0.08,0.06,0.2,0.34,0.48,0.62,0.76,0.9,1.04,1.18,1.32,1.46,1.6))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -1.2
for (i in 1:19){
  x1[i+1] = x1[i]+0.14
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-2.2,-1.965,-1.73,-1.495,-1.26,-1.025,-0.79,-0.555,-0.32,-0.085,0.15,0.385,0.62,0.855,1.09,1.325,1.56,1.795,2.03,2.265,2.5))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-2.2,-1.965,-1.73,-1.495,-1.26,-1.025,-0.79,-0.555,-0.32,-0.085,0.15,0.385,0.62,0.855,1.09,1.325,1.56,1.795,2.03,2.265,2.5))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-2.2,-1.965,-1.73,-1.495,-1.26,-1.025,-0.79,-0.555,-0.32,-0.085,0.15,0.385,0.62,0.855,1.09,1.325,1.56,1.795,2.03,2.265,2.5))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -2.2
for (i in 1:19){
  x1[i+1] = x1[i]+0.235
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-1.4,-1.245,-1.09,-0.935,-0.78,-0.625,-0.47,-0.315,-0.16,-0.005,0.15,0.305,0.46,0.615,0.77,0.925,1.08,1.235,1.39,1.545,1.7))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-1.4,-1.245,-1.09,-0.935,-0.78,-0.625,-0.47,-0.315,-0.16,-0.005,0.15,0.305,0.46,0.615,0.77,0.925,1.08,1.235,1.39,1.545,1.7))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-1.4,-1.245,-1.09,-0.935,-0.78,-0.625,-0.47,-0.315,-0.16,-0.005,0.15,0.305,0.46,0.615,0.77,0.925,1.08,1.235,1.39,1.545,1.7))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -1.4
for (i in 1:19){
  x1[i+1] = x1[i]+0.155
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-1.8,-1.59,-1.38,-1.17,-0.96,-0.75,-0.54,-0.33,-0.12,0.09,0.3,0.51,0.72,0.93,1.14,1.35,1.56,1.77,1.98,2.19,2.4))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-1.8,-1.59,-1.38,-1.17,-0.96,-0.75,-0.54,-0.33,-0.12,0.09,0.3,0.51,0.72,0.93,1.14,1.35,1.56,1.77,1.98,2.19,2.4))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-1.8,-1.59,-1.38,-1.17,-0.96,-0.75,-0.54,-0.33,-0.12,0.09,0.3,0.51,0.72,0.93,1.14,1.35,1.56,1.77,1.98,2.19,2.4))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -1.8
for (i in 1:19){
  x1[i+1] = x1[i]+0.21
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-1.2,-1.065,-0.93,-0.795,-0.66,-0.525,-0.39,-0.255,-0.12,0.015,0.15,0.285,0.42,0.555,0.69,0.825,0.96,1.095,1.23,1.365,1.5))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-1.2,-1.065,-0.93,-0.795,-0.66,-0.525,-0.39,-0.255,-0.12,0.015,0.15,0.285,0.42,0.555,0.69,0.825,0.96,1.095,1.23,1.365,1.5))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
          breaks = c(-1.2,-1.065,-0.93,-0.795,-0.66,-0.525,-0.39,-0.255,-0.12,0.015,0.15,0.285,0.42,0.555,0.69,0.825,0.96,1.095,1.23,1.365,1.5))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -1.2
for (i in 1:19){
  x1[i+1] = x1[i]+0.135
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 3.1.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green"))+
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  #guides(colour=FALSE)+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)


resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}
gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos",
       colour = " ") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)",
        color = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

R1 <- resid(REW)
R2 <- resid(RES)
R3 <- resid(RE)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 3.2.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


  
ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ",         
        shape = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)


a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)


ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}

gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ",  
        shape = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ", 
        shape = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ", 
        shape = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ", 
        shape = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ", 
        shape = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ",     
        shape = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

a <- qplot(fitted(REW), resid(REW))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(RES), resid(RES))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(RE), resid(RE))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 3.3.

### Altitude

#### Registros

```{r}
gráfico <- ggplot(AL, aes(x = FR, y = R, colour = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green"))+
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Altitude (m)",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  #guides(colour=FALSE)+
  theme_classic()

REW <- lm(WAVRAL~ALWAVR, data = dados)
RES <- lm(SPLRAL~ALSPLR, data = dados)
RE <- lm(WAV2RAL~ALWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-2.1,-1.875,-1.65,-1.425,-1.2,-0.925,-0.75,-0.525,-0.3,-0.075,0.15,0.375,0.6,0.825,1.05,1.275,1.5,1.725,1.95,2.175,2.4))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-2.1,-1.875,-1.65,-1.425,-1.2,-0.925,-0.75,-0.525,-0.3,-0.075,0.15,0.375,0.6,0.825,1.05,1.275,1.5,1.725,1.95,2.175,2.4))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
           breaks = c(-2.1,-1.875,-1.65,-1.425,-1.2,-0.925,-0.75,-0.525,-0.3,-0.075,0.15,0.375,0.6,0.825,1.05,1.275,1.5,1.725,1.95,2.175,2.4))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -2.1
for (i in 1:19){
  x1[i+1] = x1[i]+0.225


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AL, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Altitude (m)",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVEAL~ALWAVE, data = dados)
RES <- lm(SPLEAL~ALSPLE, data = dados)
RE <- lm(WAV2EAL~ALWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.3,-1.1,-0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.1,1.3,1.5,1.7,1.9,2.1,2.3,2.5,2.7))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.3,-1.1,-0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.1,1.3,1.5,1.7,1.9,2.1,2.3,2.5,2.7))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.3,-1.1,-0.9,-0.7,-0.5,-0.3,-0.1,0.1,0.3,0.5,0.7,0.9,1.1,1.3,1.5,1.7,1.9,2.1,2.3,2.5,2.7))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.3
  for (i in 1:19){
    x1[i+1] = x1[i]+0.2
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Área

#### Registros

```{r}
gráfico <- ggplot(AR, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Área (Log10(Km^2))",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRAR~ARWAVR, data = dados)
RES <- lm(SPLRAR~ARSPLR, data = dados)
RE <- lm(WAV2RAR~ARWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-2.4,-2.165,-1.93,-1.695,-1.46,-1.225,-0.99,-0.755,-0.52,-0.285,-0.05,0.185,0.42,0.655,0.89,1.125,1.36,1.595,1.83,2.065,2.3))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-2.4,-2.165,-1.93,-1.695,-1.46,-1.225,-0.99,-0.755,-0.52,-0.285,-0.05,0.185,0.42,0.655,0.89,1.125,1.36,1.595,1.83,2.065,2.3))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-2.4,-2.165,-1.93,-1.695,-1.46,-1.225,-0.99,-0.755,-0.52,-0.285,-0.05,0.185,0.42,0.655,0.89,1.125,1.36,1.595,1.83,2.065,2.3))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -2.4
  for (i in 1:19){
    x1[i+1] = x1[i]+0.235
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(AR, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "Área (Log10(Km^2))",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVEAR~ARWAVE, data = dados)
RES <- lm(SPLEAR~ARSPLE, data = dados)
RE <- lm(WAV2EAR~ARWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.4,-1.26,-1.12,-0.98,-0.84,-0.7,-0.56,-0.42,-0.28,-0.14,0,0.14,0.28,0.42,0.56,0.7,0.84,0.98,1.12,1.26,1.4))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.4,-1.26,-1.12,-0.98,-0.84,-0.7,-0.56,-0.42,-0.28,-0.14,0,0.14,0.28,0.42,0.56,0.7,0.84,0.98,1.12,1.26,1.4))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.4,-1.26,-1.12,-0.98,-0.84,-0.7,-0.56,-0.42,-0.28,-0.14,0,0.14,0.28,0.42,0.56,0.7,0.84,0.98,1.12,1.26,1.4))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.4
  for (i in 1:19){
    x1[i+1] = x1[i]+0.14
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### População

#### Registros

```{r}
gráfico <- ggplot(POP, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="População (Log10)",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRP~PWAVR, data = dados)
RES <- lm(SPLRP~PSPLR, data = dados)
RE <- lm(WAV2RP~PWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.7,-1.495,-1.29,-1.085,-0.88,-0.675,-0.47,-0.265,-0.06,0.145,0.35,0.555,0.76,0.965,1.17,1.375,1.58,1.785,1.99,2.195,2.4))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.7,-1.495,-1.29,-1.085,-0.88,-0.675,-0.47,-0.265,-0.06,0.145,0.35,0.555,0.76,0.965,1.17,1.375,1.58,1.785,1.99,2.195,2.4))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.7,-1.495,-1.29,-1.085,-0.88,-0.675,-0.47,-0.265,-0.06,0.145,0.35,0.555,0.76,0.965,1.17,1.375,1.58,1.785,1.99,2.195,2.4))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.7
  for (i in 1:19){
    x1[i+1] = x1[i]+0.205
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(POP, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x = "População (Log10)",
        y = "Número de Espécies (Log10)",
        color = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRE~PWAVE, data = dados)
RES <- lm(SPLEP~PSPLE, data = dados)
RE <- lm(WAV2EP~PWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.2,-1.06,-0.92,-0.78,-0.74,-0.5,-0.36,-0.22,-0.08,0.06,0.2,0.34,0.48,0.62,0.76,0.9,1.04,1.18,1.32,1.46,1.6))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.2,-1.06,-0.92,-0.78,-0.74,-0.5,-0.36,-0.22,-0.08,0.06,0.2,0.34,0.48,0.62,0.76,0.9,1.04,1.18,1.32,1.46,1.6))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.2,-1.06,-0.92,-0.78,-0.74,-0.5,-0.36,-0.22,-0.08,0.06,0.2,0.34,0.48,0.62,0.76,0.9,1.04,1.18,1.32,1.46,1.6))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.2
  for (i in 1:19){
    x1[i+1] = x1[i]+0.14
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Latitude

#### Registros

```{r}
gráfico <- ggplot(LA, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRLA~LAWAVR, data = dados)
RES <- lm(SPLRLA~LASPLR, data = dados)
RE <- lm(WAV2RLA~LAWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  
  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-2.2,-1.965,-1.73,-1.495,-1.26,-1.025,-0.79,-0.555,-0.32,-0.085,0.15,0.385,0.62,0.855,1.09,1.325,1.56,1.795,2.03,2.265,2.5))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-2.2,-1.965,-1.73,-1.495,-1.26,-1.025,-0.79,-0.555,-0.32,-0.085,0.15,0.385,0.62,0.855,1.09,1.325,1.56,1.795,2.03,2.265,2.5))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-2.2,-1.965,-1.73,-1.495,-1.26,-1.025,-0.79,-0.555,-0.32,-0.085,0.15,0.385,0.62,0.855,1.09,1.325,1.56,1.795,2.03,2.265,2.5))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -2.2
  for (i in 1:19){
    x1[i+1] = x1[i]+0.235
  }

A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LA, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Latitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVELA~LAWAVE, data = dados)
RES <- lm(SPLELA~LASPLE, data = dados)
RE <- lm(WAV2ELA~LAWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  
  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.4,-1.245,-1.09,-0.935,-0.78,-0.625,-0.47,-0.315,-0.16,-0.005,0.15,0.305,0.46,0.615,0.77,0.925,1.08,1.235,1.39,1.545,1.7))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.4,-1.245,-1.09,-0.935,-0.78,-0.625,-0.47,-0.315,-0.16,-0.005,0.15,0.305,0.46,0.615,0.77,0.925,1.08,1.235,1.39,1.545,1.7))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.4,-1.245,-1.09,-0.935,-0.78,-0.625,-0.47,-0.315,-0.16,-0.005,0.15,0.305,0.46,0.615,0.77,0.925,1.08,1.235,1.39,1.545,1.7))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.4
  for (i in 1:19){
    x1[i+1] = x1[i]+0.155
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

### Longitude

#### Registros

```{r}
gráfico <- ggplot(LO, aes(x = FR, y = R, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y =  "Número de Registros (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVRLO~LOWAVR, data = dados)
RES <- lm(SPLRLO~LOSPLR, data = dados)
RE <- lm(WAV2RLO~LOWAV2R, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.8,-1.59,-1.38,-1.17,-0.96,-0.75,-0.54,-0.33,-0.12,0.09,0.3,0.51,0.72,0.93,1.14,1.35,1.56,1.77,1.98,2.19,2.4))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.8,-1.59,-1.38,-1.17,-0.96,-0.75,-0.54,-0.33,-0.12,0.09,0.3,0.51,0.72,0.93,1.14,1.35,1.56,1.77,1.98,2.19,2.4))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.8,-1.59,-1.38,-1.17,-0.96,-0.75,-0.54,-0.33,-0.12,0.09,0.3,0.51,0.72,0.93,1.14,1.35,1.56,1.77,1.98,2.19,2.4))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.8
  for (i in 1:19){
    x1[i+1] = x1[i]+0.21
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

#### Espécies

```{r}
gráfico <- ggplot(LO, aes(x = FE, y = E, color = L2, shape = L2))+
  geom_point()+
  scale_colour_manual(values = c("blue", "red", "green")) +
   scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Longitude (º)",
        y = "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

REW <- lm(WAVELO~LOWAVE, data = dados)
RES <- lm(SPLELO~LOSPLE, data = dados)
RE <- lm(WAV2ELO~LOWAV2E, data = dados)

R1 <- resid (REW)
R2 <- resid (RES)
R3 <- resid (RE)

min(R1,R2,R3)
max(R1,R2,R3)

  AX <- hist(R1, 
             plot = FALSE, 
             breaks = c(-1.2,-1.065,-0.93,-0.795,-0.66,-0.525,-0.39,-0.255,-0.12,0.015,0.15,0.285,0.42,0.555,0.69,0.825,0.96,1.095,1.23,1.365,1.5))
  AX$density = AX$counts/sum(AX$counts)*100
  
  BX <- hist(R2, 
             plot = FALSE, 
             breaks = c(-1.2,-1.065,-0.93,-0.795,-0.66,-0.525,-0.39,-0.255,-0.12,0.015,0.15,0.285,0.42,0.555,0.69,0.825,0.96,1.095,1.23,1.365,1.5))
  BX$density = BX$counts/sum(BX$counts)*100
  
  CX <- hist(R3, 
             plot = FALSE, 
             breaks = c(-1.2,-1.065,-0.93,-0.795,-0.66,-0.525,-0.39,-0.255,-0.12,0.015,0.15,0.285,0.42,0.555,0.69,0.825,0.96,1.095,1.23,1.365,1.5))
  CX$density = CX$counts/sum(CX$counts)*100
  
  y1 <- AX$density
  y2 <- BX$density
  y3 <- CX$density
  
  x1 <- c()
  x1[1] <- -1.2
  for (i in 1:19){
    x1[i+1] = x1[i]+0.135
  }


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line()+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```


```{r}
rm(list=ls())
```

# Seção 4

## Representação 1.1.

```{r}
dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S4/WS.xlsx")
RW <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S4/RW.xlsx")
RS <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S4/RS.xlsx")
RW2 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S4/RW2.xlsx")
```

```{r}
gráfico <- ggplot(dados, aes(x = A2, y = A1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Registros SpeciesLink (Log10)",
        y =  "Número de Registros Wikiaves (Log10)")+
  theme_classic()

A <- lm(A1~A2, data = dados)
summary(A)

R <- resid(A)

resíduos <- ggplot()+
  geom_histogram(aes (x = R,
                      y = stat(count) / sum(count)*100, 
                      #fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1)
```

```{r}
gráfico <- ggplot(dados, aes(x = B2, y = B1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Espécies SpeciesLink (Log10)",
        y =  "Número de Espécies Wikiaves (Log10)")+
  theme_classic()

A <- lm(B1~B2, data = dados)
summary(A)

R <- resid(A)

resíduos <- ggplot()+
  geom_histogram(aes (x = R,
                      y = stat(count) / sum(count)*100, 
                      #fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1)
```

```{r}
dados$L1 <- factor(dados$L1, levels=c("Wikiaves", "SpeciesLink", "Wikiaves 2"), labels = c("WAV (N = 620)","SLI (N = 143)","WAV 2 (N = 171)"))

gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
summary(A)
B <- lm(SE~poly(SR,2), data = RS)
summary(B)
C <- lm(W2E~poly(W2R,2), data = RW2)
summary(C)
R1 <- resid (A)
R2 <- resid (B)
R3 <- resid (C)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25) +
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 1.2

```{r}
gráfico <- ggplot(dados, aes(x = A2, y = A1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Registros SpeciesLink (Log10)",
        y =  "Número de Registros Wikiaves (Log10)")+
  theme_classic()

A <- lm(A1~A2, data = dados)

resíduos <- qplot(fitted(A), resid(A))+ 
  geom_point()+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

```{r}
gráfico <- ggplot(dados, aes(x = B2, y = B1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Espécies SpeciesLink (Log10)",
        y =  "Número de Espécies Wikiaves (Log10)")+
  theme_classic()

A <- lm(B1~B2, data = dados)

resíduos <- qplot(fitted(A), resid(A))+ 
  geom_point()+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)

a <- qplot(fitted(A), resid(A))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(B), resid(B))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(C), resid(C))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

## Representação 1.3

```{r}
gráfico <- ggplot(dados, aes(x = A2, y = A1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Registros SpeciesLink (Log10)",
        y =  "Número de Registros Wikiaves (Log10)")+
  theme_classic()

A <- lm(A1~A2, data = dados)

R1 <- resid (A)

min(R1)
max(R1)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-1.7,-1.545,-1.39,-1.235,-1.08,-0.925,-0.77,-0.615,-0.46,-0.305,-0.15,0.005,0.16,0.315,0.47,0.625,0.78,0.935,1.09,1.245,1.409))
AX$density = AX$counts/sum(AX$counts)*100


y1 <- AX$density

x1 <- c()
x1[1] <- -0.3
for (i in 1:19){
  x1[i+1] = x1[i]+0.155
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

data <- data.frame(x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = y))+
  geom_line()+
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)")+
  theme_classic()



ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

```{r}
gráfico <- ggplot(dados, aes(x = B2, y = B1))+
  geom_point()+
  stat_smooth(method = "lm",
              se = FALSE,
              fullrange = TRUE,
              col = "red",
              size = 1)+
  labs( x ="Número de Espécies SpeciesLink (Log10)",
        y =  "Número de Espécies Wikiaves (Log10)")+
  theme_classic()

A <- lm(B1~B2, data = dados)

R1 <- resid (A)

min(R1)
max(R1)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-0.65,-0.5965,-0.543,-0.4895,-0.436,-0.3825,-0.329,-0.2755,-0.222,-0.1685,-0.115,-0.0615,-0.008,0.0455,0.099,0.1525,0.206,0.2595,0.313,0.3665,0.42))
AX$density = AX$counts/sum(AX$counts)*100


y1 <- AX$density

x1 <- c()
x1[1] <- -0.3
for (i in 1:19){
  x1[i+1] = x1[i]+0.0535
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

data <- data.frame(x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = y))+
  geom_line()+
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)")+
  theme_classic()



ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)

R1 <- resid (A)
R2 <- resid (B)
R3 <- resid (C)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-0.4,-0.2765,-0.253,-0.2295,-0.206,-0.1825,-0.159,-0.1355,-0.112,-0.0885,-0.065,-0.0415,-0.018,0.0055,0.029,0.0525,0.076,0.0995,0.123,0.1465,0.18))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-0.4,-0.2765,-0.253,-0.2295,-0.206,-0.1825,-0.159,-0.1355,-0.112,-0.0885,-0.065,-0.0415,-0.018,0.0055,0.029,0.0525,0.076,0.0995,0.123,0.1465,0.18))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
           breaks = c(-0.4,-0.2765,-0.253,-0.2295,-0.206,-0.1825,-0.159,-0.1355,-0.112,-0.0885,-0.065,-0.0415,-0.018,0.0055,0.029,0.0525,0.076,0.0995,0.123,0.1465,0.18))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -0.3
for (i in 1:19){
  x1[i+1] = x1[i]+0.0235
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line(fullrange = TRUE)+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

## Representação 2.1

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue","green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)

R1 <- resid (A)
R2 <- resid (B)
R3 <- resid (C)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25) +
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 2.2

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue","green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)

a <- qplot(fitted(A), resid(A))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(B), resid(B))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(C), resid(C))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

## Representação 2.3

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1, alpha =I(.5)))+
  geom_point()+
  scale_colour_manual(values = c("red", "blue","green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)


R1 <- resid (A)
R2 <- resid (B)
R3 <- resid (C)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-0.4,-0.2765,-0.253,-0.2295,-0.206,-0.1825,-0.159,-0.1355,-0.112,-0.0885,-0.065,-0.0415,-0.018,0.0055,0.029,0.0525,0.076,0.0995,0.123,0.1465,0.18))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-0.4,-0.2765,-0.253,-0.2295,-0.206,-0.1825,-0.159,-0.1355,-0.112,-0.0885,-0.065,-0.0415,-0.018,0.0055,0.029,0.0525,0.076,0.0995,0.123,0.1465,0.18))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
           breaks = c(-0.4,-0.2765,-0.253,-0.2295,-0.206,-0.1825,-0.159,-0.1355,-0.112,-0.0885,-0.065,-0.0415,-0.018,0.0055,0.029,0.0525,0.076,0.0995,0.123,0.1465,0.18))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -0.3
for (i in 1:19){
  x1[i+1] = x1[i]+0.0235
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line(fullrange = TRUE)+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 3.1

```{r}

gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1, shape = L1))+
  geom_point()+
  scale_shape_manual(values=c(15, 16, 17))+
  scale_colour_manual(values = c("blue","red", "green")) +
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
summary(A)
B <- lm(SE~poly(SR,2), data = RS)
summary(B)
C <- lm(W2E~poly(W2R,2), data = RW2)
summary(C)
R1 <- resid (A)
R2 <- resid (B)
R3 <- resid (C)

resíduos <- ggplot()+
  geom_histogram(aes (x = R1,
                      y = stat(count) / sum(count)*100, 
                      fill = I("blue"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R2,
                      y = stat(count) / sum(count)*100, 
                      fill = I("red"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25)+
  geom_histogram(aes (x = R3,
                      y = stat(count) / sum(count)*100, 
                      fill = I("green"),
                      col = I("black"),
                      alpha = I(.5)),
                 bins = 25) +
  labs(y = "Frequência Relativa (%)",
       x = "Resíduos") +
  theme_classic()

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")
```

## Representação 3.2

```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)

a <- qplot(fitted(A), resid(A))+ 
  geom_point(col = "blue")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

b <- qplot(fitted(B), resid(B))+ 
  geom_point(col = "Red")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

c <- qplot(fitted(C), resid(C))+ 
  geom_point(col = "Green")+
  geom_hline(yintercept=0) + 
  labs(y = "Resíduos",
       x = " ")+
  theme_classic()

resíduos <- ggarrange(a,b,c, ncol = 1, nrow = 3)

ggarrange(gráfico,resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

## Representação 3.3


```{r}
gráfico <- ggplot(dados, aes(x = C1, y = C2, color = L1, shape = L1))+
  geom_point()+
  scale_colour_manual(values = c("blue","red", "green")) +
  scale_shape_manual(values=c(15, 16, 17))+
  stat_smooth(method = "lm",
              formula = y~poly(x,2),
              se = FALSE,
              fullrange = TRUE,
              size = 1)+
  labs( x ="Número de Registros (Log10)",
        y =  "Número de Espécies (Log10)",
        colour = " ",
        shape = " ")+
  theme_classic()

A <- lm(WE~poly(WR,2), data = RW)
B <- lm(SE~poly(SR,2), data = RS)
C <- lm(W2E~poly(W2R,2), data = RW2)

R1 <- resid (A)
R2 <- resid (B)
R3 <- resid (C)

min(R1,R2,R3)
max(R1,R2,R3)

AX <- hist(R1, 
           plot = FALSE, 
           breaks = c(-0.4,-0.2765,-0.253,-0.2295,-0.206,-0.1825,-0.159,-0.1355,-0.112,-0.0885,-0.065,-0.0415,-0.018,0.0055,0.029,0.0525,0.076,0.0995,0.123,0.1465,0.18))
AX$density = AX$counts/sum(AX$counts)*100

BX <- hist(R2, 
           plot = FALSE, 
           breaks = c(-0.4,-0.2765,-0.253,-0.2295,-0.206,-0.1825,-0.159,-0.1355,-0.112,-0.0885,-0.065,-0.0415,-0.018,0.0055,0.029,0.0525,0.076,0.0995,0.123,0.1465,0.18))
BX$density = BX$counts/sum(BX$counts)*100

CX <- hist(R3, 
           plot = FALSE, 
           breaks = c(-0.4,-0.2765,-0.253,-0.2295,-0.206,-0.1825,-0.159,-0.1355,-0.112,-0.0885,-0.065,-0.0415,-0.018,0.0055,0.029,0.0525,0.076,0.0995,0.123,0.1465,0.18))
CX$density = CX$counts/sum(CX$counts)*100

y1 <- AX$density
y2 <- BX$density
y3 <- CX$density

x1 <- c()
x1[1] <- -0.3
for (i in 1:19){
  x1[i+1] = x1[i]+0.0235
}


A <- c()

for (i in 1:20){
  A[i] = "WAV (N = 631)"
}
for (i in 21:40){
  A[i] = "SPL (N = 174)"
}
for (i in 41:60){
  A[i] = "WAV 2 (N = 173)"
}

B <- c()

for (i in 1:20){
  B[i] = x1[i]
}

for(i in 21:40){
  B[i] = x1[i-20]
}
for(i in 41:60){
  B[i] = x1[i-40]
}

C<- c()

for (i in 1:20){
  C[i] = y1[i]
}

for(i in 21:40){
  C[i] = y2[i-20]
}
for(i in 41:60){
  C[i] = y3[i-40]
}

data <- data.frame(L = A, x = B, y = C)

Resíduos <-  ggplot(data, aes(x = x, y = C, colour = L))+
  geom_line(fullrange = TRUE)+
  scale_colour_manual(values = c("red", "blue", "green")) +
  #stat_smooth(method = lm, formula = y ~ poly(x, 4),se = FALSE, fullrange = TRUE)+
  labs(x = "Resíduos",
       y = "Frequência Relativa (%)",
       colour = " ")+
  theme_classic()


ggarrange(gráfico, Resíduos,  ncol = 2, nrow = 1, common.legend = TRUE, legend = "right")

```

```{r}
rm(list=ls())
```

# Seção 5

```{r}
Dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S5/Mapas.xlsx")
FE <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/R/S5/Mapas2.xlsx")
mc <- read_municipality(code_muni= "SP")
```

```{r}
FAT <- merge(mc,FE)
cid <- merge(mc,Dados)
```

```{r}
FAT$AL <- cut(FAT$Altitude, breaks = c(0,200,400,600,800,1000,1200,1400,1600,Inf),
              labels = c("0-200","200-400","400-600","600-800","800-1000","1000-1200","1200-1400","1400-1600","1600+"))

FAT$AR <- cut(FAT$Area, breaks = c(0,250,500,750,1000,1250,1500,Inf), 
              labels = c("0-250","250-500","500-750","750-1000","1000-1250","1250-1500","1500+"))

FAT$POP <- cut(FAT$Populacao, breaks = c(0,1500000,300000,4500000,6000000,7500000,9000000,10500000,12000000,Inf), 
                labels = c("0 - 1.500.000","1.500.000 - 3.000.000","3.000.000 - 4.500.000" , "4.500.000 - 6.000.000","6.000.000 - 7.500.000","7.500.000 - 9.000.000", "9.000.000 - 10.500.000","10.500.000 - 12.000.000","12.000.000+"))

FAT$LAT <- cut(FAT$Latitude, breaks = c(-26,-25,-24,-23,-22,-21,-20,Inf), 
                labels = c("-26 a -25","-25 a -24","-24 a -23","-23 a -22","-22 a -21", "-21 a -20","-20+"))

FAT$LOG <- cut(FAT$Longitude, breaks = c(-55,-52.5,-50,-47.5,-45,Inf), 
                labels = c("-55 a -52.5","-52.5 a -50","-50 a -47.5","-47.5 a -45","-45 +"))

FAT$LAR <- cut(FAT$AreaL, breaks = c(0,0.5,1,1.5,2,2.5,3,3.5,4),
               labels = c("0 - 0.5","0.5 - 1", "1 - 1.5", "1.5 - 2", "2 - 2.5", "2.5 - 3", "3 - 3.5","3.5 - 4"))

FAT$LPOP <- cut (FAT$PopulacaoL, breaks = c(2,3,4,5,6,7,8), 
                 labels = c("2 - 3", "3 - 4", "4 - 5", "5 - 6", "6 - 7", "7+"))
```

## Altitude

```{r}
ggplot(FAT) +  
  geom_sf(aes(fill=AL), color = NA) + 
  labs(subtitle="", size=8)+ 
  scale_fill_manual (values = brewer.pal(9,'OrRd'))+  
  labs(fill = "Altitude (m) ")+  
  theme_minimal()
```

## Área

```{r}
ggplot(FAT) +
  geom_sf(aes(fill=LAR), color = NA) +
  labs(subtitle=" ", size=8)+  
  scale_fill_manual (values = brewer.pal(7,'OrRd'))+  
  labs(fill = "Área (Log10(km^2))")+  
  theme_minimal()
```

## População

```{r}
ggplot(FAT) + 
  geom_sf(aes(fill=LPOP), color = NA) + 
  labs(subtitle="", size=8)+   
  scale_fill_manual (values = brewer.pal(9,'OrRd'))+  
  labs(fill = "População (Log10)")+ 
  theme_minimal()
```

##Latitude

```{r}
ggplot(FAT) + 
  geom_sf(aes(fill=LAT), color = NA) + 
  labs(subtitle="", size=8)+  
  scale_fill_manual (values = brewer.pal(7,'OrRd'))+ 
  labs(fill = "Latitude (°) ")+ 
  theme_minimal()
```


##Longitude

```{r}
ggplot(FAT) + 
  geom_sf(aes(fill=LOG), color = NA) + 
  labs(subtitle="", size=8)+  
  scale_fill_manual (values = brewer.pal(6,'OrRd'))+ 
  labs(fill = "Longitude  (°)")+ 
  theme_minimal()
```


```{r}
cid$WEI <- cut(cid$WAVE, breaks = c(-1,0,100,200,300,400,Inf), 
               labels=c("0","1 a 100","101 a 200","201 a 300","301 a 400","401+"))

cid$SEI <- cut(cid$SPLE, breaks = c(-1,0,50,100,150,200,Inf),
               labels= c("0","1 a 50","51 a 100","101 a 150","151 a 200","201+"))

cid$WRI <- cut(cid$WAVR, breaks = c(-1,0,5000,10000,15000,20000,25000,30000,35000, Inf), 
               labels=c("0","1 a 5000","5001 a 10000","10001 a 15000","15001 a 20000","20001 a 25000","25001 a 30000", "30001 a 35000","35000+"))

cid$SRI <- cut(cid$SPLR, breaks = c(-1,0,800,1600,2400,3200,4000,4800,5600,Inf),
               labels= c("0","1 a 800","801 a 1600","1601 a 2400","2401 a 3200","3201 a 4000","4001 a 4800","4801 a 5600","5601+"))

cid$LWEI <- cut(cid$LWAVE, breaks = c(-2,-1,0,1.00,1.5,2.0,2.5,Inf),
                labels = c("Sem registro","0.00","0.01 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00"))

cid$LSEI <- cut(cid$LSPLE, breaks = c(-2,-1,0,1.00,1.5,2.0,2.5,Inf),
                labels = c("Sem registro","0.00","0.01 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00"))

cid$LWRI <- cut(cid$LWAVR, breaks = c(-2,-1,1.00,1.5,2.0,2.5,3.00,3.5,4,Inf),
                labels = c("Sem registro","0.00 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00","3.01 a 3.50","3.51 a 4.00","4.01+"))

cid$LSRI <- cut(cid$LSPLR, breaks = c(-2,-1,1.00,1.5,2.0,2.5,3.00,3.5,4,Inf),
                labels = c("Sem registro","0.00 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00","3.01 a 3.50","3.51 a 4.00","4.01+"))

cid$LW2EI <- cut(cid$LWAV2E, breaks = c(-2,-1,0,1.00,1.5,2.0,2.5,Inf),
                 labels = c("Sem registro","0.00","0.01 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00"))

cid$LW2RI <- cut(cid$LWAV2R, breaks = c(-2,-1,1.00,1.5,2.0,2.5,3.00,3.5,4,Inf),
                 labels = c("Sem registro","0.00 a 1.00","1.01 a 1.50","1.51 a 2.00","2.01 a 2.50","2.51 a 3.00","3.01 a 3.50","3.51 a 4.00","4.01+"))

```

```{r}
A <- ggplot(cid) +
  geom_sf(aes(fill=LWEI), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f'))+
  labs(fill = "Espécies (Log10) ")+
  theme_minimal()

B <- ggplot(cid) +
  geom_sf(aes(fill=LW2EI), color = NA) +
  labs(subtitle="Wikiaves 2", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f'))+
  labs(fill = "Espécies (Log10) ")+
  theme_minimal()


C <- ggplot(cid) +
  geom_sf(aes(fill=LSEI), color = NA) +
  labs(subtitle="SpeciesLink ", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f'))+
  labs(fill = "Espécies (Log10) ")+
  theme_minimal()


D <- ggplot(cid) +
  geom_sf(aes(fill=LSRI), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f','#b30000','#7f0000'))+
  labs(fill = "Registros (Log10) ")+
  theme_minimal()

E <- ggplot(cid) +
  geom_sf(aes(fill=LWRI), color = NA) +
  labs(subtitle="Wikiaves", size=8)+
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f','#b30000','#7f0000'))+
  labs(fill = "Registros (Log10) ")+
  theme_minimal()

G <- ggplot(cid) +
  geom_sf(aes(fill=LW2RI), color = NA) +
  labs(subtitle="Wikiaves 2", size=8)+
  scale_fill_manual (values = c('#f0f0f0','#fdd49e','#fdbb84','#feb24c','#fc8d59','#ef6548','#d7301f','#b30000','#7f0000'))+
  labs(fill = "Registros (Log10) ")+
  theme_minimal()

ggarrange(E,A,D,C,G,B, ncol = 2, nrow = 3)

```

```{r}
rm(list=ls())
```

# Seção 6

```{r}
library(pacman)

pacman::p_load(tidyverse, cluster, gclus, factoextra, dendextend, sf, psych, geobr, ggplot2, openxlsx, ade4, vegan, car, rstatix, multcomp, emmeans, RVAideMemoire, psych, DescTools)
```

# Todos os Municípios

```{r}
WAV <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/WAV-E.xlsx", sheet = "Geral")

WAV <- t(WAV)
is.numeric(WAV)

SLI <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/SPL-E.xlsx", sheet = "Geral")

SLI <- t(SLI)
is.numeric(SLI)

WAV2 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Grupos2.xlsx", sheet = "WAVE")

WAV2 <- t(WAV2)
is.numeric(WAV2)

SLI2 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Grupos2.xlsx", sheet = "SLIE")

SLI2 <- t(SLI2)
is.numeric(SLI2)

dados <- read.xlsx("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Mapas.xlsx")
dados2 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Grupos2.xlsx", sheet = "Mapas")
mc <- read_municipality(code_muni= "SP")

maps <- merge(mc,dados)
maps2 <- merge(mc, dados2)

N1 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Grupos.xlsx", sheet = "K = 2")
N2 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Grupos.xlsx", sheet = "K = 3")
N3 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Grupos.xlsx", sheet = "K = 4")
N4 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Grupos.xlsx", sheet = "K = 5")
N5 <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Grupos.xlsx", sheet = "K = 6")

N <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S6/Grupos2.xlsx", sheet = "Dados")
```

```{r}
A <- vegdist(WAV, method = "jaccard", binary = TRUE)
B <- vegdist(SLI, method = "jaccard", binary = TRUE)

hc1 <- hclust(A, method = "ward.D2" )
hc2 <- hclust(B, method = "ward.D2" )

gap_stat1 <- clusGap(WAV, FUN = hcut, K.max = 25, B = 10)
fviz_gap_stat(gap_stat1)
gap_stat2 <- clusGap(SLI, FUN = hcut, K.max = 25, B = 10)
fviz_gap_stat(gap_stat2)

dend1 <- as.dendrogram (hc1)
dend2 <- as.dendrogram (hc2)

entanglement(dend1, 
             dend2,
             L = 1,
             leaves_matching_method = c("order"))
```

## K = 2

```{r}
tanglegram(dend1, dend2,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 2)
```

```{r}
grp1 <- cutree(hc1, k = 2)
grp1

grp2 <- cutree(hc2, k = 2)
grp2

maps$WAV2 <- cut(maps$dendWAV2, breaks = c(-2,0,1,2),
                 labels = c("Sem Registro","Grupo 1","Grupo 2"))

maps$SLI2 <- cut(maps$dendSLI2, breaks = c(-2,0,1,2),
                 labels = c("Sem Registro","Grupo 1","Grupo 2"))
```

```{r}
ggplot(maps) +
  geom_sf(aes(fill=WAV2), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#009681','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
```

```{r}
ggplot(maps) +
  geom_sf(aes(fill=SLI2), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#009681','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
```


```{r}
byf.shapiro(WAL ~ Grupo.W, N1)
byf.shapiro(WAR ~ Grupo.W, N1)
byf.shapiro(WP ~ Grupo.W, N1)
byf.shapiro(WLA ~ Grupo.W, N1)
byf.shapiro(WLO ~ Grupo.W, N1)

byf.shapiro(SAL ~ Grupo.S, N1)
byf.shapiro(SAR ~ Grupo.S, N1)
byf.shapiro(SP ~ Grupo.S, N1)
byf.shapiro(SLA ~ Grupo.S, N1)
byf.shapiro(SLO ~ Grupo.S, N1)

leveneTest(WAL ~ Grupo.W, N1, mean)
leveneTest(WAR ~ Grupo.W, N1, mean)
leveneTest(WP ~ Grupo.W, N1, mean)
leveneTest(WLA ~ Grupo.W, N1, mean)
leveneTest(WLO ~ Grupo.W, N1, mean)

leveneTest(SAL ~ Grupo.S, N1, mean)
leveneTest(SAR ~ Grupo.S, N1, mean)
leveneTest(SP ~ Grupo.S, N1, mean)
leveneTest(SLA ~ Grupo.S, N1, mean)
leveneTest(SLO ~ Grupo.S, N1, mean)


oneway.test(WAL ~ Grupo.W, data = N1, var.equal=FALSE)
oneway.test(WAR ~ Grupo.W, data = N1, var.equal=TRUE)
oneway.test(WP ~ Grupo.W, data = N1, var.equal=TRUE)
oneway.test(WLA ~ Grupo.W, data = N1, var.equal=FALSE)
oneway.test(WLO ~ Grupo.W, data = N1, var.equal=TRUE)

oneway.test(SAL ~ Grupo.S, data = N1, var.equal=FALSE)
oneway.test(SAR ~ Grupo.S, data = N1, var.equal=TRUE)
oneway.test(SP ~ Grupo.S, data = N1, var.equal=TRUE)
oneway.test(SLA ~ Grupo.S, data = N1, var.equal=TRUE)
oneway.test(SLO ~ Grupo.S, data = N1, var.equal=FALSE)


mod <- aov(WAL ~ Grupo.W, N1)
PostHocTest(mod, method = "hsd")
mod <- aov(WAR ~ Grupo.W, N1)
PostHocTest(mod, method = "hsd")
mod <- aov(WP ~ Grupo.W, N1)
PostHocTest(mod, method = "hsd")
mod <- aov(WLA ~ Grupo.W, N1)
PostHocTest(mod, method = "hsd")
mod <- aov(WLO ~ Grupo.W, N1)
PostHocTest(mod, method = "hsd")

mod <- aov(SAL ~ Grupo.S, N1)
PostHocTest(mod, method = "hsd")
mod <- aov(SAR ~ Grupo.S, N1)
PostHocTest(mod, method = "hsd")
mod <- aov(SP ~ Grupo.S, N1)
PostHocTest(mod, method = "hsd")
mod <- aov(SLA ~ Grupo.S, N1)
PostHocTest(mod, method = "hsd")
mod <- aov(SLO ~ Grupo.S, N1)
PostHocTest(mod, method = "hsd")
```


## K = 3

```{r}
tanglegram(dend1, dend2,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 3)
```


grp1 <- cutree(hc1, k = 3)
grp1

grp2 <- cutree(hc2, k = 3)
grp2

maps$WAV3 <- cut(maps$dendWAV3, breaks = c(-2,0,1,2,3),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3"))

maps$SLI3 <- cut(maps$dendSLI3, breaks = c(-2,0,1,2,3),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3"))

png("61231.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=WAV3), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#0082CE','#228B00','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("612231.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=SLI3), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#0082CE','#228B00','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

byf.shapiro(WAL ~ Grupo.W, N2)
byf.shapiro(WAR ~ Grupo.W, N2)
byf.shapiro(WP ~ Grupo.W, N2)
byf.shapiro(WLA ~ Grupo.W, N2)
byf.shapiro(WLO ~ Grupo.W, N2)

byf.shapiro(SAL ~ Grupo.S, N2)
byf.shapiro(SAR ~ Grupo.S, N2)
byf.shapiro(SP ~ Grupo.S, N2)
byf.shapiro(SLA ~ Grupo.S, N2)
byf.shapiro(SLO ~ Grupo.S, N2)

leveneTest(WAL ~ Grupo.W, N2, mean)
leveneTest(WAR ~ Grupo.W, N2, mean)
leveneTest(WP ~ Grupo.W, N2, mean)
leveneTest(WLA ~ Grupo.W, N2, mean)
leveneTest(WLO ~ Grupo.W, N2, mean)

leveneTest(SAL ~ Grupo.S, N2, mean)
leveneTest(SAR ~ Grupo.S, N2, mean)
leveneTest(SP ~ Grupo.S, N2, mean)
leveneTest(SLA ~ Grupo.S, N2, mean)
leveneTest(SLO ~ Grupo.S, N2, mean)

oneway.test(WAL ~ Grupo.W, data = N2, var.equal=FALSE)
oneway.test(WAR ~ Grupo.W, data = N2, var.equal=TRUE)
oneway.test(WP ~ Grupo.W, data = N2, var.equal=TRUE)
oneway.test(WLA ~ Grupo.W, data = N2, var.equal=FALSE)
oneway.test(WLO ~ Grupo.W, data = N2, var.equal=FALSE)

oneway.test(SAL ~ Grupo.S, data = N2, var.equal=FALSE)
oneway.test(SAR ~ Grupo.S, data = N2, var.equal=FALSE)
oneway.test(SP ~ Grupo.S, data = N2, var.equal= FALSE)
oneway.test(SLA ~ Grupo.S, data = N2, var.equal=FALSE)
oneway.test(SLO ~ Grupo.S, data = N2, var.equal=TRUE)


mod <- aov(WAL ~ Grupo.W, N2)
PostHocTest(mod, method = "hsd")
mod <- aov(WAR ~ Grupo.W, N2)
PostHocTest(mod, method = "hsd")
mod <- aov(WP ~ Grupo.W, N2)
PostHocTest(mod, method = "hsd")
mod <- aov(WLA ~ Grupo.W, N2)
PostHocTest(mod, method = "hsd")
mod <- aov(WLO ~ Grupo.W, N2)
PostHocTest(mod, method = "hsd")

mod <- aov(SAL ~ Grupo.S, N2)
PostHocTest(mod, method = "hsd")
mod <- aov(SAR ~ Grupo.S, N2)
PostHocTest(mod, method = "hsd")
mod <- aov(SP ~ Grupo.S, N2)
PostHocTest(mod, method = "hsd")
mod <- aov(SLA ~ Grupo.S, N2)
PostHocTest(mod, method = "hsd")
mod <- aov(SLO ~ Grupo.S, N2)
PostHocTest(mod, method = "hsd")


## K = 4

png("6114.png", width = 1500, height = 2000)
tanglegram(dend1, dend2,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 4)
dev.off()

grp1 <- cutree(hc1, k = 4)
grp1

grp2 <- cutree(hc2, k = 4)
grp2

maps$WAV4 <- cut(maps$dendWAV4, breaks = c(-2,0,1,2,3,4),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4"))

maps$SLI4 <- cut(maps$dendSLI4, breaks = c(-2,0,1,2,3,4),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4"))

png("61241.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=WAV4), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#7866D8','#767F00','#CC476B','#009681'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("61242.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=SLI4), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#7866D8','#767F00','#CC476B','#009681'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

byf.shapiro(WAL ~ Grupo.W, N3)
byf.shapiro(WAR ~ Grupo.W, N3)
byf.shapiro(WP ~ Grupo.W, N3)
byf.shapiro(WLA ~ Grupo.W, N3)
byf.shapiro(WLO ~ Grupo.W, N3)

byf.shapiro(SAL ~ Grupo.S, N3)
byf.shapiro(SAR ~ Grupo.S, N3)
byf.shapiro(SP ~ Grupo.S, N3)
byf.shapiro(SLA ~ Grupo.S, N3)
byf.shapiro(SLO ~ Grupo.S, N3)

leveneTest(WAL ~ Grupo.W, N3, mean)
leveneTest(WAR ~ Grupo.W, N3, mean)
leveneTest(WP ~ Grupo.W, N3, mean)
leveneTest(WLA ~ Grupo.W, N3, mean)
leveneTest(WLO ~ Grupo.W, N3, mean)

leveneTest(SAL ~ Grupo.S, N3, mean)
leveneTest(SAR ~ Grupo.S, N3, mean)
leveneTest(SP ~ Grupo.S, N3, mean)
leveneTest(SLA ~ Grupo.S, N3, mean)
leveneTest(SLO ~ Grupo.S, N3, mean)

oneway.test(WAL ~ Grupo.W, data = N3, var.equal=FALSE)
oneway.test(WAR ~ Grupo.W, data = N3, var.equal= TRUE)
oneway.test(WP ~ Grupo.W, data = N3, var.equal= FALSE)
oneway.test(WLA ~ Grupo.W, data = N3, var.equal=FALSE)
oneway.test(WLO ~ Grupo.W, data = N3, var.equal=FALSE)

oneway.test(SAL ~ Grupo.S, data = N3, var.equal=FALSE)
oneway.test(SAR ~ Grupo.S, data = N3, var.equal=TRUE)
oneway.test(SP ~ Grupo.S, data = N3, var.equal=TRUE)
oneway.test(SLA ~ Grupo.S, data = N3, var.equal=FALSE)
oneway.test(SLO ~ Grupo.S, data = N3, var.equal=TRUE)


mod <- aov(WAL ~ Grupo.W, N3)
PostHocTest(mod, method = "hsd")
mod <- aov(WAR ~ Grupo.W, N3)
PostHocTest(mod, method = "hsd")
mod <- aov(WP ~ Grupo.W, N3)
PostHocTest(mod, method = "hsd")
mod <- aov(WLA ~ Grupo.W, N3)
PostHocTest(mod, method = "hsd")
mod <- aov(WLO ~ Grupo.W, N3)
PostHocTest(mod, method = "hsd")

mod <- aov(SAL ~ Grupo.S, N3)
PostHocTest(mod, method = "hsd")
mod <- aov(SAR ~ Grupo.S, N3)
PostHocTest(mod, method = "hsd")
mod <- aov(SP ~ Grupo.S, N3)
PostHocTest(mod, method = "hsd")
mod <- aov(SLA ~ Grupo.S, N3)
PostHocTest(mod, method = "hsd")
mod <- aov(SLO ~ Grupo.S, N3)
PostHocTest(mod, method = "hsd")


## K = 5

png("6115.png", width = 1500, height = 2000)
tanglegram(dend1, dend2,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 5)
dev.off()

grp1 <- cutree(hc1, k = 5)
grp1

grp2 <- cutree(hc2, k = 5)
grp2

maps$WAV5 <- cut(maps$dendWAV5, breaks = c(-2,0,1,2,3,4,5),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5"))

maps$SLI5 <- cut(maps$dendSLI5, breaks = c(-2,0,1,2,3,4,5),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5"))

png("61251.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=WAV5), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#B646C7','#228B00','#9F7000','#0082CE','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("61252.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=SLI5), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#B646C7','#228B00','#9F7000','#0082CE','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

byf.shapiro(WAL ~ Grupo.W, N4)
byf.shapiro(WAR ~ Grupo.W, N4)
byf.shapiro(WP ~ Grupo.W, N4)
byf.shapiro(WLA ~ Grupo.W, N4)
byf.shapiro(WLO ~ Grupo.W, N4)

byf.shapiro(SAL ~ Grupo.S, N4)
byf.shapiro(SAR ~ Grupo.S, N4)
byf.shapiro(SP ~ Grupo.S, N4)
byf.shapiro(SLA ~ Grupo.S, N4)
byf.shapiro(SLO ~ Grupo.S, N4)

leveneTest(WAL ~ Grupo.W, N4, mean)
leveneTest(WAR ~ Grupo.W, N4, mean)
leveneTest(WP ~ Grupo.W, N4, mean)
leveneTest(WLA ~ Grupo.W, N4, mean)
leveneTest(WLO ~ Grupo.W, N4, mean)

leveneTest(SAL ~ Grupo.S, N4, mean)
leveneTest(SAR ~ Grupo.S, N4, mean)
leveneTest(SP ~ Grupo.S, N4, mean)
leveneTest(SLA ~ Grupo.S, N4, mean)
leveneTest(SLO ~ Grupo.S, N4, mean)

oneway.test(WAL ~ Grupo.W, data = N4, var.equal=FALSE)
oneway.test(WAR ~ Grupo.W, data = N4, var.equal=TRUE)
oneway.test(WP ~ Grupo.W, data = N4, var.equal=FALSE)
oneway.test(WLA ~ Grupo.W, data = N4, var.equal=FALSE)
oneway.test(WLO ~ Grupo.W, data = N4, var.equal=FALSE)

oneway.test(SAL ~ Grupo.S, data = N4, var.equal=FALSE)
oneway.test(SAR ~ Grupo.S, data = N4, var.equal=TRUE)
oneway.test(SP ~ Grupo.S, data = N4, var.equal=TRUE)
oneway.test(SLA ~ Grupo.S, data = N4, var.equal=FALSE)
oneway.test(SLO ~ Grupo.S, data = N4, var.equal=TRUE)


mod <- aov(WAL ~ Grupo.W, N4)
PostHocTest(mod, method = "hsd")
mod <- aov(WAR ~ Grupo.W, N4)
PostHocTest(mod, method = "hsd")
mod <- aov(WP ~ Grupo.W, N4)
PostHocTest(mod, method = "hsd")
mod <- aov(WLA ~ Grupo.W, N4)
PostHocTest(mod, method = "hsd")
mod <- aov(WLO ~ Grupo.W, N4)
PostHocTest(mod, method = "hsd")

mod <- aov(SAL ~ Grupo.S, N4)
PostHocTest(mod, method = "hsd")
mod <- aov(SAR ~ Grupo.S, N4)
PostHocTest(mod, method = "hsd")
mod <- aov(SP ~ Grupo.S, N4)
PostHocTest(mod, method = "hsd")
mod <- aov(SLA ~ Grupo.S, N4)
PostHocTest(mod, method = "hsd")
mod <- aov(SLO ~ Grupo.S, N4)
PostHocTest(mod, method = "hsd")

## K = 6

png("6116.png", width = 1500, height = 2000)
tanglegram(dend1, dend2,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           #sort = TRUE,
           k_branches = 6)
           #main = paste("entanglement =", round(entanglement(dendlist), 2))
dev.off()

grp1 <- cutree(hc1, k = 6)
grp1

grp2 <- cutree(hc2, k = 6)
grp2


maps$WAV6 <- cut(maps$dendWAV6, breaks = c(-2,0,1,2,3,4,5,6),
              labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5","Grupo 6"))

maps$SLI6 <- cut(maps$dendSLI6, breaks = c(-2,0,1,2,3,4,5,6),
                labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5","Grupo 6"))

png("61261.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=WAV6), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#B646C7','#228B00','#9F7000','#0082CE','#CC476B','#009681'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("61262.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=SLI6), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#B646C7','#228B00','#9F7000','#0082CE','#CC476B','#009681'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

byf.shapiro(WAL ~ Grupo.W, N5)
byf.shapiro(WAR ~ Grupo.W, N5)
byf.shapiro(WP ~ Grupo.W, N5)
byf.shapiro(WLA ~ Grupo.W, N5)
byf.shapiro(WLO ~ Grupo.W, N5)

byf.shapiro(SAL ~ Grupo.S, N5)
byf.shapiro(SAR ~ Grupo.S, N5)
byf.shapiro(SP ~ Grupo.S, N5)
byf.shapiro(SLA ~ Grupo.S, N5)
byf.shapiro(SLO ~ Grupo.S, N5)

leveneTest(WAL ~ Grupo.W, N5, mean)
leveneTest(WAR ~ Grupo.W, N5, mean)
leveneTest(WP ~ Grupo.W, N5, mean)
leveneTest(WLA ~ Grupo.W, N5, mean)
leveneTest(WLO ~ Grupo.W, N5, mean)

leveneTest(SAL ~ Grupo.S, N5, mean)
leveneTest(SAR ~ Grupo.S, N5, mean)
leveneTest(SP ~ Grupo.S, N5, mean)
leveneTest(SLA ~ Grupo.S, N5, mean)
leveneTest(SLO ~ Grupo.S, N5, mean)

oneway.test(WAL ~ Grupo.W, data = N5, var.equal=FALSE)
oneway.test(WAR ~ Grupo.W, data = N5, var.equal=FALSE)
oneway.test(WP ~ Grupo.W, data = N5, var.equal=FALSE)
oneway.test(WLA ~ Grupo.W, data = N5, var.equal=FALSE)
oneway.test(WLO ~ Grupo.W, data = N5, var.equal=FALSE)

oneway.test(SAL ~ Grupo.S, data = N5, var.equal=FALSE)
oneway.test(SAR ~ Grupo.S, data = N5, var.equal=TRUE)
oneway.test(SP ~ Grupo.S, data = N5, var.equal=TRUE)
oneway.test(SLA ~ Grupo.S, data = N5, var.equal=FALSE)
oneway.test(SLO ~ Grupo.S, data = N5, var.equal=TRUE)


mod <- aov(WAL ~ Grupo.W, N5)
PostHocTest(mod, method = "hsd")
mod <- aov(WAR ~ Grupo.W, N5)
PostHocTest(mod, method = "hsd")
mod <- aov(WP ~ Grupo.W, N5)
PostHocTest(mod, method = "hsd")
mod <- aov(WLA ~ Grupo.W, N5)
PostHocTest(mod, method = "hsd")
mod <- aov(WLO ~ Grupo.W, N5)
PostHocTest(mod, method = "hsd")

mod <- aov(SAL ~ Grupo.S, N5)
PostHocTest(mod, method = "hsd")
mod <- aov(SAR ~ Grupo.S, N5)
PostHocTest(mod, method = "hsd")
mod <- aov(SP ~ Grupo.S, N5)
PostHocTest(mod, method = "hsd")
mod <- aov(SLA ~ Grupo.S, N5)
PostHocTest(mod, method = "hsd")
mod <- aov(SLO ~ Grupo.S, N5)
PostHocTest(mod, method = "hsd")

## K = 7

png("6117.png", width = 1500, height = 2000)
tanglegram(dend1, dend2,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 7)
dev.off()

grp1 <- cutree(hc1, k = 7)
grp1

grp2 <- cutree(hc2, k = 7)
grp2

maps$WAV7 <- cut(maps$dendWAV7, breaks = c(-2,0,1,2,3,4,5,6,7),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5","Grupo 6","Grupo 7"))

maps$SLI7 <- cut(maps$dendSLI7, breaks = c(-2,0,1,2,3,4,5,6,7),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5","Grupo 6","Grupo 7"))

png("61271.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=WAV7), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#C03FBE','#4473D7','#0093A9','#00944F','#5D8400','#A86B00','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("61272.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=SLI7), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#C03FBE','#4473D7','#0093A9','#00944F','#5D8400','#A86B00','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

## K = 8

png("6118.png", width = 1500, height = 2000)
tanglegram(dend1, dend2,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 8)
dev.off()

grp1 <- cutree(hc1, k = 8)
grp1

grp2 <- cutree(hc2, k = 8)
grp2


maps$WAV8 <- cut(maps$dendWAV8, breaks = c(-2,0,1,2,3,4,5,6,7,8),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5","Grupo 6","Grupo 7","Grupo 8"))

maps$SLI8 <- cut(maps$dendSLI8, breaks = c(-2,0,1,2,3,4,5,6,7,8),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5","Grupo 6","Grupo 7","Grupo 8"))

png("61281.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=WAV8), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#C03FBE','#4473D7','#0093A9','#00944F','#5D8400','#A86B00','#CC476B','#7866D8'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("61282.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=SLI8), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#C03FBE','#4473D7','#0093A9','#00944F','#5D8400','#A86B00','#CC476B','#7866D8'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

## K = 9

png("6119.png", width = 1500, height = 2000)
tanglegram(dend1, dend2,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 9)
dev.off()


grp1 <- cutree(hc1, k = 9)
grp1

grp2 <- cutree(hc2, k = 9)
grp2

maps$WAV9 <- cut(maps$dendWAV9, breaks = c(-2,0,1,2,3,4,5,6,7,8,9),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5","Grupo 6","Grupo 7","Grupo 8", "Grupo 9"))

maps$SLI9 <- cut(maps$dendSLI9, breaks = c(-2,0,1,2,3,4,5,6,7,8,9),
                 labels = c("Sem Registro","Grupo 1","Grupo 2","Grupo 3","Grupo 4","Grupo 5","Grupo 6","Grupo 7","Grupo 8", "Grupo 9"))

png("61291.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=WAV9), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#C03FBE','#4473D7','#0093A9','#00944F','#5D8400','#A86B00','#CC476B','#7866D8','#009681'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("61292.png", width = 600, height = 300)
ggplot(maps) +
  geom_sf(aes(fill=SLI9), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#C03FBE','#4473D7','#0093A9','#00944F','#5D8400','#A86B00','#CC476B','#7866D8','#009681'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

# Top 50


WJ <- vegdist(WAV2, method = "jaccard", binary = TRUE)
SJ <- vegdist(SLI2, method = "jaccard", binary = TRUE)

hc3 <- hclust(WJ, method = "ward.D2" )
hc4 <- hclust(SJ, method = "ward.D2" )


dend3 <- as.dendrogram (hc3)
dend4 <- as.dendrogram (hc4)

# k = 2

png("6212.png", width = 1500, height = 2000)
tanglegram(dend3, dend4,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 2)
dev.off()

maps2$WK2 <- factor(maps2$WK2, levels=c("Sem Registro", "Grupo 1", "Grupo 2"))

maps2$SK2 <- factor(maps2$SK2, levels=c("Sem Registro", "Grupo 1", "Grupo 2"))

png("62221.png", width = 600, height = 300)
ggplot(maps2) +
  geom_sf(aes(fill=WK2), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#009681','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("62222.png", width = 600, height = 300)
ggplot(maps2) +
  geom_sf(aes(fill=SK2), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#009681','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

grp1 <- cutree(hc3, k = 2)
grp1

grp2 <- cutree(hc4, k = 2)
grp2

byf.shapiro(AL ~ GW2, N)
byf.shapiro(AR ~ GW2, N)
byf.shapiro(POP ~ GW2, N)
byf.shapiro(LA ~ GW2, N)
byf.shapiro(LO ~ GW2, N)

byf.shapiro(AL ~ GS2, N)
byf.shapiro(AR ~ GS2, N)
byf.shapiro(POP ~ GS2, N)
byf.shapiro(LA ~ GS2, N)
byf.shapiro(LO ~ GS2, N)


leveneTest(AL ~ GW2, N, mean)
leveneTest(AR ~ GW2, N, mean)
leveneTest(POP ~ GW2, N, mean)
leveneTest(LA ~ GW2, N, mean)
leveneTest(LO ~ GW2, N, mean)

leveneTest(AL ~ GS2, N, mean)
leveneTest(AR ~ GS2, N, mean)
leveneTest(POP ~ GS2, N, mean)
leveneTest(LA ~ GS2, N, mean)
leveneTest(LO ~ GS2, N, mean)

oneway.test(AL ~ GW2, data = N, var.equal=FALSE)
oneway.test(AR ~ GW2, data = N, var.equal=TRUE)
oneway.test(POP ~ GW2, data = N, var.equal=TRUE)
oneway.test(LA ~ GW2, data = N, var.equal=TRUE)
oneway.test(LO ~ GW2, data = N, var.equal=TRUE)

oneway.test(AL ~ GS2, data = N, var.equal=TRUE)
oneway.test(AR ~ GS2, data = N, var.equal=TRUE)
oneway.test(POP ~ GS2, data = N, var.equal=TRUE)
oneway.test(LA ~ GS2, data = N, var.equal=FALSE)
oneway.test(LO ~ GS2, data = N, var.equal=FALSE)


mod <- aov(AL ~ GW2, N)
PostHocTest(mod, method = "hsd")
mod <- aov(AR ~ GW2, N)
PostHocTest(mod, method = "hsd")
mod <- aov(POP ~ GW2, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LA ~ GW2, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LO ~ GW2, N)
PostHocTest(mod, method = "hsd")

mod <- aov(AL ~ GS2, N)
PostHocTest(mod, method = "hsd")
mod <- aov(AR ~ GS2, N)
PostHocTest(mod, method = "hsd")
mod <- aov(POP ~ GS2, N5)
PostHocTest(mod, method = "hsd")
mod <- aov(LA ~ GS2, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LO ~ GS2, N)
PostHocTest(mod, method = "hsd")


# k = 3




png("6213.png", width = 1500, height = 2000)
tanglegram(dend3, dend4,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 3)
dev.off()

maps2$WK3 <- factor(maps2$WK3, levels=c("Sem Registro", "Grupo 1", "Grupo 2","Grupo 3"))

maps2$SK3 <- factor(maps2$SK3, levels=c("Sem Registro", "Grupo 1", "Grupo 2","Grupo 3"))

png("62231.png", width = 600, height = 300)
ggplot(maps2) +
  geom_sf(aes(fill=WK3), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#0082CE','#228B00','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("62232.png", width = 600, height = 300)
ggplot(maps2) +
  geom_sf(aes(fill=SK3), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#0082CE','#228B00','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

grp1 <- cutree(hc3, k = 3)
grp1

grp2 <- cutree(hc4, k = 3)
grp2


byf.shapiro(AL ~ GW3, N)
byf.shapiro(AR ~ GW3, N)
byf.shapiro(POP ~ GW3, N)
byf.shapiro(LA ~ GW3, N)
byf.shapiro(LO ~ GW3, N)

byf.shapiro(AL ~ GS3, N)
byf.shapiro(AR ~ GS3, N)
byf.shapiro(POP ~ GS3, N)
byf.shapiro(LA ~ GS3, N)
byf.shapiro(LO ~ GS3, N)


leveneTest(AL ~ GW3, N, mean)
leveneTest(AR ~ GW3, N, mean)
leveneTest(POP ~ GW3, N, mean)
leveneTest(LA ~ GW3, N, mean)
leveneTest(LO ~ GW3, N, mean)

leveneTest(AL ~ GS3, N, mean)
leveneTest(AR ~ GS3, N, mean)
leveneTest(POP ~ GS3, N, mean)
leveneTest(LA ~ GS3, N, mean)
leveneTest(LO ~ GS3, N, mean)

oneway.test(AL ~ GW3, data = N, var.equal=TRUE)
oneway.test(AR ~ GW3, data = N, var.equal=TRUE)
oneway.test(POP ~ GW3, data = N, var.equal=FALSE)
oneway.test(LA ~ GW3, data = N, var.equal=TRUE)
oneway.test(LO ~ GW3, data = N, var.equal=TRUE)

oneway.test(AL ~ GS3, data = N, var.equal=FALSE)
oneway.test(AR ~ GS3, data = N, var.equal=TRUE)
oneway.test(POP ~ GS3, data = N, var.equal=TRUE)
oneway.test(LA ~ GS3, data = N, var.equal=FALSE)
oneway.test(LO ~ GS3, data = N, var.equal=FALSE)


mod <- aov(AL ~ GW3, N)
PostHocTest(mod, method = "hsd")
mod <- aov(AR ~ GW3, N)
PostHocTest(mod, method = "hsd")
mod <- aov(POP ~ GW3, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LA ~ GW3, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LO ~ GW3, N)
PostHocTest(mod, method = "hsd")

mod <- aov(AL ~ GS3, N)
PostHocTest(mod, method = "hsd")
mod <- aov(AR ~ GS3, N)
PostHocTest(mod, method = "hsd")
mod <- aov(POP ~ GS3, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LA ~ GS3, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LO ~ GS3, N)
PostHocTest(mod, method = "hsd")

# k = 4

png("6214.png", width = 1500, height = 2000)
tanglegram(dend3, dend4,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 4)
dev.off()

maps2$WK4 <- factor(maps2$WK4, levels=c("Sem Registro", "Grupo 1", "Grupo 2","Grupo 3", "Grupo 4"))

maps2$SK4 <- factor(maps2$SK4, levels=c("Sem Registro", "Grupo 1", "Grupo 2","Grupo 3", "Grupo 4"))

png("62241.png", width = 600, height = 300)
ggplot(maps2) +
  geom_sf(aes(fill=WK4), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#7866D8','#767F00','#CC476B','#009681'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("62242.png", width = 600, height = 300)
ggplot(maps2) +
  geom_sf(aes(fill=SK4), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#7866D8','#767F00','#CC476B','#009681'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()


grp1 <- cutree(hc3, k = 4)
grp1

grp2 <- cutree(hc4, k = 4)
grp2

byf.shapiro(AL ~ GW4, N)
byf.shapiro(AR ~ GW4, N)
byf.shapiro(POP ~ GW4, N)
byf.shapiro(LA ~ GW4, N)
byf.shapiro(LO ~ GW4, N)

byf.shapiro(AL ~ GS4, N)
byf.shapiro(AR ~ GS4, N)
byf.shapiro(POP ~ GS4, N)
byf.shapiro(LA ~ GS4, N)
byf.shapiro(LO ~ GS4, N)


leveneTest(AL ~ GW4, N, mean)
leveneTest(AR ~ GW4, N, mean)
leveneTest(POP ~ GW4, N, mean)
leveneTest(LA ~ GW4, N, mean)
leveneTest(LO ~ GW4, N, mean)

leveneTest(AL ~ GS4, N, mean)
leveneTest(AR ~ GS4, N, mean)
leveneTest(POP ~ GS4, N, mean)
leveneTest(LA ~ GS4, N, mean)
leveneTest(LO ~ GS4, N, mean)

oneway.test(AL ~ GW4, data = N, var.equal=FALSE)
oneway.test(AR ~ GW4, data = N, var.equal=TRUE)
oneway.test(POP ~ GW4, data = N, var.equal=FALSE)
oneway.test(LA ~ GW4, data = N, var.equal=TRUE)
oneway.test(LO ~ GW4, data = N, var.equal=TRUE)

oneway.test(AL ~ GS4, data = N, var.equal=FALSE)
oneway.test(AR ~ GS4, data = N, var.equal=TRUE)
oneway.test(POP ~ GS4, data = N, var.equal=TRUE)
oneway.test(LA ~ GS4, data = N, var.equal=FALSE)
oneway.test(LO ~ GS4, data = N, var.equal=TRUE)


mod <- aov(AL ~ GW4, N)
PostHocTest(mod, method = "hsd")
mod <- aov(AR ~ GW4, N)
PostHocTest(mod, method = "hsd")
mod <- aov(POP ~ GW4, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LA ~ GW4, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LO ~ GW4, N)
PostHocTest(mod, method = "hsd")

mod <- aov(AL ~ GS4, N)
PostHocTest(mod, method = "hsd")
mod <- aov(AR ~ GS4, N)
PostHocTest(mod, method = "hsd")
mod <- aov(POP ~ GS4, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LA ~ GS4, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LO ~ GS4, N)
PostHocTest(mod, method = "hsd")

# k = 5

png("6215.png", width = 1500, height = 2000)
tanglegram(dend3, dend4,
           highlight_distinct_edges = FALSE, 
           common_subtrees_color_lines = TRUE, 
           common_subtrees_color_branches = FALSE,
           main_left = "Wikiaves",
           main_right = "SpeciesLink",
           lwd = .5,
           k_branches = 5)
dev.off()

maps2$WK5 <- factor(maps2$WK5, levels=c("Sem Registro", "Grupo 1", "Grupo 2","Grupo 3", "Grupo 4", "Grupo 5"))

maps2$SK5 <- factor(maps2$SK5, levels=c("Sem Registro", "Grupo 1", "Grupo 2","Grupo 3", "Grupo 4", "Grupo 5"))

png("62251.png", width = 600, height = 300)
ggplot(maps2) +
  geom_sf(aes(fill=WK5), color = NA) +
  labs(subtitle="Wikiaves", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#B646C7','#228B00','#9F7000','#0082CE','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

png("62252.png", width = 600, height = 300)
ggplot(maps2) +
  geom_sf(aes(fill=SK5), color = NA) +
  labs(subtitle="SpeciesLink", size=8)+ 
  scale_fill_manual (values = c('#f0f0f0','#B646C7','#228B00','#9F7000','#0082CE','#CC476B'))+
  labs(fill = " ")+
  theme_minimal()
dev.off()

grp1 <- cutree(hc3, k = 5)
grp1

grp2 <- cutree(hc4, k = 5)
grp2

byf.shapiro(AL ~ GW5, N)
byf.shapiro(AR ~ GW5, N)
byf.shapiro(POP ~ GW5, N)
byf.shapiro(LA ~ GW5, N)
byf.shapiro(LO ~ GW5, N)

byf.shapiro(AL ~ GS5, N)
byf.shapiro(AR ~ GS5, N)
byf.shapiro(POP ~ GS5, N)
byf.shapiro(LA ~ GS5, N)
byf.shapiro(LO ~ GS5, N)


leveneTest(AL ~ GW5, N, mean)
leveneTest(AR ~ GW5, N, mean)
leveneTest(POP ~ GW5, N, mean)
leveneTest(LA ~ GW5, N, mean)
leveneTest(LO ~ GW5, N, mean)

leveneTest(AL ~ GS5, N, mean)
leveneTest(AR ~ GS5, N, mean)
leveneTest(POP ~ GS5, N, mean)
leveneTest(LA ~ GS5, N, mean)
leveneTest(LO ~ GS5, N, mean)

oneway.test(AL ~ GW5, data = N, var.equal=TRUE)
oneway.test(AR ~ GW5, data = N, var.equal=TRUE)
oneway.test(POP ~ GW5, data = N, var.equal=FALSE)
oneway.test(LA ~ GW5, data = N, var.equal=FALSE)
oneway.test(LO ~ GW5, data = N, var.equal=TRUE)

oneway.test(AL ~ GS5, data = N, var.equal=TRUE)
oneway.test(AR ~ GS5, data = N, var.equal=TRUE)
oneway.test(POP ~ GS5, data = N, var.equal=FALSE)
oneway.test(LA ~ GS5, data = N, var.equal=FALSE)
oneway.test(LO ~ GS5, data = N, var.equal=TRUE)


mod <- aov(AL ~ GW5, N)
PostHocTest(mod, method = "hsd")
mod <- aov(AR ~ GW5, N)
PostHocTest(mod, method = "hsd")
mod <- aov(POP ~ GW5, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LA ~ GW5, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LO ~ GW5, N)
PostHocTest(mod, method = "hsd")

mod <- aov(AL ~ GS5, N)
PostHocTest(mod, method = "hsd")
mod <- aov(AR ~ GS5, N)
PostHocTest(mod, method = "hsd")
mod <- aov(POP ~ GS5, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LA ~ GS5, N)
PostHocTest(mod, method = "hsd")
mod <- aov(LO ~ GS5, N)
PostHocTest(mod, method = "hsd")

```{r}
rm(list=ls())
```

# Seção 7

library(pacman)

pacman::p_load(dplyr, car, rstatix, lmtest, ggpubr, QuantPsyc, psych, scatterplot3d, ggplot2, openxlsx)

dados <- read.xlsx ("C:/Users/bia99/OneDrive/Documents/Wikiaves/ProjWAV/Excel/S7/RM.xlsx")

# Registros

modMS1 <- lm(RS ~ LAS + LOS, dados)
modMS2 <- lm(RS ~ LAS + LOS + AS, dados)
modlaS <- lm(RS ~ LAS, dados)
modloS <- lm(RS ~ LOS, dados)
modAS <- lm(RS ~ AS, dados)

modMW1 <- lm(RW ~ LAW + LOW, dados)
modMW2 <- lm(RW ~ LAW + LOW + AW, dados)
modlaW <- lm(RW ~ LAW, dados)
modloW <- lm(RW ~ LOW, dados)
modAW <- lm(RW ~ AW, dados)

modMW21 <- lm(RW2 ~ LAW2 + LOW2, dados)
modMW22 <- lm(RW2 ~ LAW2 + LOW2 + AW2, dados)
modlaW2 <- lm(RW2 ~ LAW2, dados)
modloW2 <- lm(RW2 ~ LOW2, dados)
modAW2 <- lm(RW2 ~ AW2, dados)

plot(modMW1)
plot(modMS1)
plot(modMW21)

plot(modMW2)
plot(modMS2)
plot(modMW22)

vif(modMW1)
vif(modMS1)
vif(modMS2)
vif(modMW2)
vif(modMW21)
vif(modMW22)

# não há multicolinearidade

```{r}
summary(modMW1)
summary(modMS1)
summary(modMW21)
```

```{r}
summary(modMW2)
summary(modMS2)
summary(modMW22)
```

# Qual o melhor modelo?


```{r}
anova(modMS1, modMS2, modlaS, modloS, modAS)
AIC(modMS1, modMS2, modlaS, modloS, modAS)
BIC(modMS1, modMS2, modlaS, modloS, modAS)

anova(modMW1, modMW2, modlaW, modloW, modAW)
AIC(modMW1, modMW2, modlaW, modloW, modAW)
BIC(modMW1, modMW2, modlaW, modloW, modAW)

anova(modMW21, modMW22, modlaW2, modloW2, modAW2)
AIC(modMW21, modMW22, modlaW2, modloW2, modAW2)
BIC(modMW21, modMW22, modlaW2, modloW2, modAW2)
```

```{r}
G1 <- scatterplot3d(dados$RS ~ dados$LAS + dados$LOS, 
                   pch = 16,
                   angle = 45,
                   box = FALSE,
                   color = "red",
                   xlab = "Latitude (º)", ylab = "Longitude (º)", zlab = "Registros (Log10)")

```

```{r}
G2 <- scatterplot3d(dados$RW ~ dados$LAW + dados$LOW, 
                   pch = 16,
                   angle = 45,
                   box = FALSE,
                   color = "blue",
                   xlab = "Latitude (º)", ylab = "Longitude (º)", zlab = "Registros (Log10)")

```

```{r}
G3 <- scatterplot3d(dados$RW2 ~ dados$LAW2 + dados$LOW2, 
                    pch = 16,
                    angle = 45,
                    box = FALSE,
                    color = "green",
                    xlab = "Latitude (º)", ylab = "Longitude (º)", zlab = "Registros (Log10)")
```

                    
                

# Espécies

```{r}
modMS1 <- lm(ES ~ LAS + LOS, dados)
modMS2 <- lm(ES ~ LAS + LOS + AS, dados)
modMS3 <- lm(ES ~ LAS + LOS + RS, dados)
modMS4 <- lm(ES ~ LAS + LOS + AS + RS, dados)
modlaS <- lm(ES ~ LAS, dados)
modloS <- lm(ES ~ LOS, dados)
modAS <- lm(ES ~ AS, dados)
modRS <- lm(ES ~ RS, dados)

modMW1 <- lm(EW ~ LAW + LOW, dados)
modMW2 <- lm(EW ~ LAW + LOW + AW, dados)
modMW3 <- lm(EW ~ LAW + LOW + RW, dados)
modMW4 <- lm(EW ~ LAW + LOW + AW + RW, dados)
modlaW <- lm(EW ~ LAW, dados)
modloW <- lm(EW ~ LOW, dados)
modAW <- lm(EW ~ AW, dados)
modRW <- lm(EW ~ RW, dados)

modMW21 <- lm(EW2 ~ LAW2 + LOW2, dados)
modMW22 <- lm(EW2 ~ LAW2 + LOW2 + AW2, dados)
modMW23 <- lm(EW2 ~ LAW2 + LOW2 + RW2, dados)
modMW24 <- lm(EW2 ~ LAW2 + LOW2 + AW2 + RW2, dados)
modlaW2 <- lm(EW2 ~ LAW2, dados)
modloW2 <- lm(EW2 ~ LOW2, dados)
modAW2 <- lm(EW2 ~ AW2, dados)
modRW2 <- lm(EW2 ~ RW2, dados)
```

```{r}
plot(modMW1)
plot(modMS1)
plot(modMW21)
```


```{r}
plot(modMW2)
plot(modMS2)
plot(modMW22)
```

```{r}
plot(modMW3)
plot(modMS3)
plot(modMW23)
```

```{r}
plot(modMW4)
plot(modMS4)
plot(modMW24)
```

```{r}
vif(modMW1)
vif(modMW2)
vif(modMW3)
vif(modMW4)

vif(modMS1)
vif(modMS2)
vif(modMS3)
vif(modMS4)

vif(modMW21)
vif(modMW22)
vif(modMW23)
vif(modMW24)



summary(modMW1)
summary(modMS1)
summary(modMW21)

summary(modMW2)
summary(modMS2)
summary(modMW22)

summary(modMW3)
summary(modMS3)
summary(modMW23)

summary(modMW4)
summary(modMS4)
summary(modMW24)



AIC(modMS1, modMS2,modMS3,modMS4, modlaS, modloS, modAS, modRS)
BIC(modMS1, modMS2,modMS3,modMS4, modlaS, modloS, modAS, modRS)

AIC(modMW1, modMW2,modMW3, modMW4, modlaW, modloW, modAW, modRW)
BIC(modMW1, modMW2,modMW3, modMW4, modlaW, modloW, modAW, modRW)

AIC(modMW21, modMW22,modMW23, modMW24, modlaW2, modloW2, modAW2, modRW2)
BIC(modMW21, modMW22,modMW23, modMW24, modlaW2, modloW2, modAW2, modRW2)
```


```{r}
rm(list=ls())
```
